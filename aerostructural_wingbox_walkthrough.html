
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Aerostructural with Wingbox Walkthrough &#8212; OpenAeroStruct 2.1.0 documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/style.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="More Examples" href="more_examples.html" />
    <link rel="prev" title="Aerostructural Walkthrough" href="aerostructural_walkthrough.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="more_examples.html" title="More Examples"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="aerostructural_walkthrough.html" title="Aerostructural Walkthrough"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">OpenAeroStruct 2.1.0 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick_example.html">Quick Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="aero_walkthrough.html">Aerodynamic Optimization Walkthrough</a></li>
<li class="toctree-l1"><a class="reference internal" href="struct_example.html">Structural Optimization Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="aerostructural_walkthrough.html">Aerostructural Walkthrough</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Aerostructural with Wingbox Walkthrough</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="more_examples.html">More Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="specialty_topics.html">Specialty Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="v1_v2_conversion.html">OpenAeroStruct v1 to v2 Conversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="how_to_contribute.html">How to Contribute to OpenAeroStruct</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="_srcdocs/index.html">Source Docs</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="aerostructural-with-wingbox-walkthrough">
<span id="id1"></span><h1>Aerostructural with Wingbox Walkthrough<a class="headerlink" href="#aerostructural-with-wingbox-walkthrough" title="Permalink to this headline">¶</a></h1>
<p>In addition to the tubular-spar structural model available in OpenAeroStruct, you can use a wingbox-based model.
This model is described in Chauhan and Martins’ paper <a class="reference external" href="https://www.researchgate.net/publication/327654423_Low-Fidelity_Aerostructural_Optimization_of_Aircraft_Wings_with_a_Simplified_Wingbox_Model_Using_OpenAeroStruct">here</a>.
We strongly recommend reading this relatively short conference paper to learn about the model and see some example results.
The presentation slides for this conference paper can be found <a class="reference external" href="https://www.researchgate.net/publication/327802989_Presentation_slides_for_Low-fidelity_Aerostructural_Optimization_of_Aircraft_Wings_with_a_Simplified_Wingbox_Model_Using_OpenAeroStruct">online</a>.
Analytic derivatives are not provided for some components of this model, so any optimization problem will use the complex-step approximation to obtain the relevant partial derivatives for these components.</p>
<img alt="_images/wingbox_fine.png" src="_images/wingbox_fine.png" />
<p>This page breaks down and describes an example optimization run-script that uses the wingbox model.
This example uses the same optimization problem used for the paper linked above, but with fewer design variables and a coarser mesh.
The wing being optimized is based on the undeflected Common Research Model (uCRM), which is a long-range transport aircraft.
A script to replicate the optimization problems described in the paper can be found in the examples directory (openaerostruct/examples/run_aerostruct_uCRM_multipoint.py).
Please contact Shamsheer Chauhan (<a class="reference external" href="mailto:sschau&#37;&#52;&#48;umich&#46;edu">sschau<span>&#64;</span>umich<span>&#46;</span>edu</a>) with any questions you have after reading the above paper and going through this example.</p>
<p>The goal of the wingbox model is to allow more realistic preliminary structural sizing for commuter to long-range transport-type aircraft which typically have wingbox structures.
Since more realistic sizing is one of the goals of the wingbox model, this example also shows how to use it with a multipoint optimization.
Wing structures are usually sized using loads that do not occur during normal cruise conditions, so we must consider at least one more flight point that provides more extreme loads.</p>
<p>This tutorial assumes that the reader has gone through the other examples and tutorials in the OpenAeroStruct documentation and is now familiar with how to set up problems and the terminology of OpenAeroStruct.</p>
<p>Let’s begin and look at the run-script now. First we import some modules.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">openaerostruct.geometry.utils</span> <span class="k">import</span> <span class="n">generate_mesh</span>
<span class="kn">from</span> <span class="nn">openaerostruct.integration.aerostruct_groups</span> <span class="k">import</span> <span class="n">AerostructGeometry</span><span class="p">,</span> <span class="n">AerostructPoint</span>
<span class="kn">from</span> <span class="nn">openmdao.api</span> <span class="k">import</span> <span class="n">IndepVarComp</span><span class="p">,</span> <span class="n">Problem</span><span class="p">,</span> <span class="n">ScipyOptimizeDriver</span><span class="p">,</span> <span class="n">SqliteRecorder</span><span class="p">,</span> <span class="n">ExecComp</span>
<span class="kn">from</span> <span class="nn">openaerostruct.structures.wingbox_fuel_vol_delta</span> <span class="k">import</span> <span class="n">WingboxFuelVolDelta</span>
<span class="kn">from</span> <span class="nn">openaerostruct.utils.constants</span> <span class="k">import</span> <span class="n">grav_constant</span>

</pre></div>
</div>
<p>Next, we provide some airfoil coordinates.
These coordinates are used to define the shape of the wingbox cross-section.
In this example, we use the NASA SC2-0612 coordinates from airfoiltools.com.
However, here we only provide the coordinates for the 10%- to 60%-chord portion of the airfoil because for this example we assume that it is this portion of the chord along the wing that will be structural and form the wingbox.
Make sure that the first and last x-coordinates (chordwise) of the upper and lower curves are the same.
Also make sure that the chord length of the original airfoil has been normalized to 1 (this is normally the case for the airfoil coordinates available on airfoiltools.com).</p>
<p>These coordinates will be scaled based on the effective chord and thickness-to-chord ratio for each wingbox segment along the wing.
However, we currently have not implemented the functionality to specify different airfoil coordinates for different segments of the wing, so the same coordinates are used for the entire wing.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># Provide coordinates for a portion of an airfoil for the wingbox cross-section as an nparray with dtype=complex (to work with the complex-step approximation for derivatives).</span>
<span class="c1"># These should be for an airfoil with the chord scaled to 1.</span>
<span class="c1"># We use the 10% to 60% portion of the NASA SC2-0612 airfoil for this case</span>
<span class="c1"># We use the coordinates available from airfoiltools.com. Using such a large number of coordinates is not necessary.</span>
<span class="c1"># The first and last x-coordinates of the upper and lower surfaces must be the same</span>

<span class="n">upper_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">0.14</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.18</span><span class="p">,</span> <span class="mf">0.19</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.21</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">,</span> <span class="mf">0.23</span><span class="p">,</span> <span class="mf">0.24</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.26</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.29</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.31</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.36</span><span class="p">,</span> <span class="mf">0.37</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.41</span><span class="p">,</span> <span class="mf">0.42</span><span class="p">,</span> <span class="mf">0.43</span><span class="p">,</span> <span class="mf">0.44</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.48</span><span class="p">,</span> <span class="mf">0.49</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.51</span><span class="p">,</span> <span class="mf">0.52</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">,</span> <span class="mf">0.54</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.56</span><span class="p">,</span> <span class="mf">0.57</span><span class="p">,</span> <span class="mf">0.58</span><span class="p">,</span> <span class="mf">0.59</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;complex128&#39;</span><span class="p">)</span>
<span class="n">lower_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">0.14</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.18</span><span class="p">,</span> <span class="mf">0.19</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.21</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">,</span> <span class="mf">0.23</span><span class="p">,</span> <span class="mf">0.24</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.26</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.29</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.31</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.36</span><span class="p">,</span> <span class="mf">0.37</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.41</span><span class="p">,</span> <span class="mf">0.42</span><span class="p">,</span> <span class="mf">0.43</span><span class="p">,</span> <span class="mf">0.44</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.48</span><span class="p">,</span> <span class="mf">0.49</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.51</span><span class="p">,</span> <span class="mf">0.52</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">,</span> <span class="mf">0.54</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.56</span><span class="p">,</span> <span class="mf">0.57</span><span class="p">,</span> <span class="mf">0.58</span><span class="p">,</span> <span class="mf">0.59</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;complex128&#39;</span><span class="p">)</span>
<span class="n">upper_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.0447</span><span class="p">,</span>  <span class="mf">0.046</span><span class="p">,</span>  <span class="mf">0.0472</span><span class="p">,</span>  <span class="mf">0.0484</span><span class="p">,</span>  <span class="mf">0.0495</span><span class="p">,</span>  <span class="mf">0.0505</span><span class="p">,</span>  <span class="mf">0.0514</span><span class="p">,</span>  <span class="mf">0.0523</span><span class="p">,</span>  <span class="mf">0.0531</span><span class="p">,</span>  <span class="mf">0.0538</span><span class="p">,</span> <span class="mf">0.0545</span><span class="p">,</span>  <span class="mf">0.0551</span><span class="p">,</span>  <span class="mf">0.0557</span><span class="p">,</span> <span class="mf">0.0563</span><span class="p">,</span>  <span class="mf">0.0568</span><span class="p">,</span> <span class="mf">0.0573</span><span class="p">,</span>  <span class="mf">0.0577</span><span class="p">,</span>  <span class="mf">0.0581</span><span class="p">,</span>  <span class="mf">0.0585</span><span class="p">,</span>  <span class="mf">0.0588</span><span class="p">,</span>  <span class="mf">0.0591</span><span class="p">,</span>  <span class="mf">0.0593</span><span class="p">,</span>  <span class="mf">0.0595</span><span class="p">,</span>  <span class="mf">0.0597</span><span class="p">,</span>  <span class="mf">0.0599</span><span class="p">,</span>  <span class="mf">0.06</span><span class="p">,</span>    <span class="mf">0.0601</span><span class="p">,</span>  <span class="mf">0.0602</span><span class="p">,</span>  <span class="mf">0.0602</span><span class="p">,</span>  <span class="mf">0.0602</span><span class="p">,</span>  <span class="mf">0.0602</span><span class="p">,</span>  <span class="mf">0.0602</span><span class="p">,</span>  <span class="mf">0.0601</span><span class="p">,</span>  <span class="mf">0.06</span><span class="p">,</span>    <span class="mf">0.0599</span><span class="p">,</span>  <span class="mf">0.0598</span><span class="p">,</span>  <span class="mf">0.0596</span><span class="p">,</span>  <span class="mf">0.0594</span><span class="p">,</span>  <span class="mf">0.0592</span><span class="p">,</span>  <span class="mf">0.0589</span><span class="p">,</span>  <span class="mf">0.0586</span><span class="p">,</span>  <span class="mf">0.0583</span><span class="p">,</span>  <span class="mf">0.058</span><span class="p">,</span>   <span class="mf">0.0576</span><span class="p">,</span>  <span class="mf">0.0572</span><span class="p">,</span>  <span class="mf">0.0568</span><span class="p">,</span>  <span class="mf">0.0563</span><span class="p">,</span>  <span class="mf">0.0558</span><span class="p">,</span>  <span class="mf">0.0553</span><span class="p">,</span>  <span class="mf">0.0547</span><span class="p">,</span>  <span class="mf">0.0541</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;complex128&#39;</span><span class="p">)</span>
<span class="n">lower_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.0447</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.046</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0473</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0485</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0496</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0506</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0515</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0524</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0532</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.054</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0547</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0554</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.056</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0565</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.057</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0575</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0579</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0583</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0586</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0589</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0592</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0594</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0595</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0596</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0597</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0598</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0598</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0598</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0598</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0597</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0596</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0594</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0592</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0589</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0586</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0582</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0578</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0573</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0567</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0561</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0554</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0546</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0538</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0529</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0519</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0509</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0497</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0485</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0472</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0458</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0444</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;complex128&#39;</span><span class="p">)</span>

</pre></div>
</div>
<p>Next, we create the dictionary with information for the mesh and create the mesh.
For this example we use the uCRM-based geometry (undeflected Common Research Model) already defined and available in OpenAeroStruct.
Alternatively, the user can provide their own mesh (see <a class="reference internal" href="more_examples/aerostructural_wingbox_Q400.html#aerostructural-with-wingbox-q400"><span class="std std-ref">Aerostructural with wingbox (Q400)</span></a> for another example with a custom mesh).
Here we specify 15 as the number of spanwise nodes and 3 as the number of chordwise nodes for the VLM mesh.
We also set <cite>chord_cos_spacing</cite> and <cite>span_cos_spacing</cite> to <cite>0</cite> for uniform panel spacing.
The FEM model will use the spanwise spacing of the VLM mesh for the FEM mesh.
We use a very coarse mesh for this example to keep the computational time low.</p>
<p>The <cite>generate_mesh</cite> function takes the inputs from the mesh dictionary and returns the mesh as well as values for the B-spline control points for the twist distribution (we specify the number of control points for this using <cite>num_twist_cp</cite> in the dictionary).
Note that in this example we don’t end up using this twist distribution, but instead use a better starting twist distribution which will be seen later.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># Create a dictionary to store options about the surface</span>
<span class="n">mesh_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;num_y&#39;</span> <span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
             <span class="s1">&#39;num_x&#39;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
             <span class="s1">&#39;wing_type&#39;</span> <span class="p">:</span> <span class="s1">&#39;uCRM_based&#39;</span><span class="p">,</span>
             <span class="s1">&#39;symmetry&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
             <span class="s1">&#39;chord_cos_spacing&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
             <span class="s1">&#39;span_cos_spacing&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
             <span class="s1">&#39;num_twist_cp&#39;</span> <span class="p">:</span> <span class="mi">4</span>
             <span class="p">}</span>

<span class="n">mesh</span><span class="p">,</span> <span class="n">twist_cp</span> <span class="o">=</span> <span class="n">generate_mesh</span><span class="p">(</span><span class="n">mesh_dict</span><span class="p">)</span>

</pre></div>
</div>
<p>Next, we create a surface dictionary and provide necessary information for our lifting surface.
After providing the relevant information for the <cite>name</cite>, <cite>symmetry</cite>, and <cite>S_ref_type</cite> settings, we provide the mesh and specify the string <cite>‘wingbox’</cite> for the <cite>fem_model_type</cite> (if we wanted the tubular structure, we would specify <cite>‘tube’</cite> instead).
We also provide the airfoil coordinates for the wingbox cross-section here as the four arrays defined earlier.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">surf_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># Wing definition</span>
            <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;wing&#39;</span><span class="p">,</span>         <span class="c1"># give the surface some name</span>
            <span class="s1">&#39;symmetry&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>       <span class="c1"># if True, model only one half of the lifting surface</span>
            <span class="s1">&#39;S_ref_type&#39;</span> <span class="p">:</span> <span class="s1">&#39;projected&#39;</span><span class="p">,</span> <span class="c1"># how we compute the wing area,</span>
                                     <span class="c1"># can be &#39;wetted&#39; or &#39;projected&#39;</span>
            <span class="s1">&#39;mesh&#39;</span> <span class="p">:</span> <span class="n">mesh</span><span class="p">,</span>

            <span class="s1">&#39;fem_model_type&#39;</span> <span class="p">:</span> <span class="s1">&#39;wingbox&#39;</span><span class="p">,</span> <span class="c1"># &#39;wingbox&#39; or &#39;tube&#39;</span>
            <span class="s1">&#39;data_x_upper&#39;</span> <span class="p">:</span> <span class="n">upper_x</span><span class="p">,</span>
            <span class="s1">&#39;data_x_lower&#39;</span> <span class="p">:</span> <span class="n">lower_x</span><span class="p">,</span>
            <span class="s1">&#39;data_y_upper&#39;</span> <span class="p">:</span> <span class="n">upper_y</span><span class="p">,</span>
            <span class="s1">&#39;data_y_lower&#39;</span> <span class="p">:</span> <span class="n">lower_y</span><span class="p">,</span>

</pre></div>
</div>
<p>Next, we provide some initial values for the wingbox spar and skin thickness distributions (B-spline control points), along with the wing twist distribution (note that these distributions do not need to have the same number of control points).
For the wingbox model, to maintain simplicity, we use the same thickness variables for both the top and bottom wing skins.
Similarly, we use the same thickness variables for the front and rear spars.
Currently, we do not model buckling or have any buckling constraints.
However, a comparison of optimized skin thicknesses with high-fidelity results shown in these <a class="reference external" href="https://www.researchgate.net/publication/327802989_Presentation_slides_for_Low-fidelity_Aerostructural_Optimization_of_Aircraft_Wings_with_a_Simplified_Wingbox_Model_Using_OpenAeroStruct">slides</a>, indicates that, assuming the wing has a reasonable rib spacing, this is not a very major concern.</p>
<p>We also provide a distribution for the thickness-to-chord ratio (B-spline control points for <cite>t_over_c_cp</cite>).
The thickness-to-chord ratio design variable is important for the trade-off between aerodynamic (wave and viscous drag) benefits from a thin wing and structural benefits from a thick wing.
The <cite>original_wingbox_airfoil_t_over_c</cite> is the thickness-to-chord ratio of the airfoil provided for the wingbox cross-section.
For this example, the thickness-to-chord ratio of the SC2-0612 is 12%.
This is used to scale the airfoil in the thickness direction as the thickness-to-chord ratio variable changes.
Note that the thickness-to-chord ratio variable is the streamwise value.
Using the sweep angle for the wingbox elements OpenAeroStruct computes the effective values for the wingbox cross-sections normal to the elements.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
            <span class="s1">&#39;twist_cp&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">,</span> <span class="mf">9.</span><span class="p">]),</span> <span class="c1"># [deg]</span>

            <span class="s1">&#39;spar_thickness_cp&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.004</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.008</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]),</span> <span class="c1"># [m]</span>
            <span class="s1">&#39;skin_thickness_cp&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.015</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">]),</span> <span class="c1"># [m]</span>

            <span class="s1">&#39;t_over_c_cp&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">]),</span>
            <span class="s1">&#39;original_wingbox_airfoil_t_over_c&#39;</span> <span class="p">:</span> <span class="mf">0.12</span><span class="p">,</span>

</pre></div>
</div>
<p>Next, we provide some information related to aerodynamics and specify some options.
We set <cite>CDO</cite> to 0.0078 to account for the drag from the fuselage, tail surfaces, nacelles, and pylons (which are not being modeled).
We set <cite>with_viscous</cite> to <cite>True</cite> to make OpenAeroStruct include an estimate for viscous drag (empirical equations) when computing the drag of the wing.
We set <cite>with_wave</cite> to <cite>True</cite> to make OpenAeroStruct also include an estimate for wave drag using the empirical equations based on the Korn equation.
This wave drag estimate needs a thickness-to-chord ratio value and a sweep angle value for the wing.
This is computed internally by averaging the thickness-to-chord ratios and sweep angles across the span of the wing weighted by the widths of the corresponding VLM panels.
Keep this in mind when creating wing meshes and setting up optimization problems using the wingbox model.
The optimizer may try to take advantage of this averaging.</p>
<p>The <cite>k_lam</cite> value is the fraction of the chord assumed to have laminar flow, and is used for OpenAeroStruct’s viscous drag estimates (empirical equations).
The <cite>c_max_t</cite> value is the location of the maximum thickness of the airfoil along the chord, and is also used for OpenAeroStruct’s viscous drag estimates.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
            <span class="c1"># Aerodynamic deltas.</span>
            <span class="c1"># These CL0 and CD0 values are added to the CL and CD</span>
            <span class="c1"># obtained from aerodynamic analysis of the surface to get</span>
            <span class="c1"># the total CL and CD.</span>
            <span class="c1"># These CL0 and CD0 values do not vary wrt alpha.</span>
            <span class="c1"># They can be used to account for things that are not included, such as contributions from the fuselage, camber, etc.</span>
            <span class="s1">&#39;CL0&#39;</span> <span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>            <span class="c1"># CL delta</span>
            <span class="s1">&#39;CD0&#39;</span> <span class="p">:</span> <span class="mf">0.0078</span><span class="p">,</span>         <span class="c1"># CD delta</span>

            <span class="s1">&#39;with_viscous&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># if true, compute viscous drag</span>
            <span class="s1">&#39;with_wave&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>     <span class="c1"># if true, compute wave drag</span>

            <span class="c1"># Airfoil properties for viscous drag calculation</span>
            <span class="s1">&#39;k_lam&#39;</span> <span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>         <span class="c1"># fraction of chord with laminar</span>
                                    <span class="c1"># flow, used for viscous drag</span>
            <span class="s1">&#39;c_max_t&#39;</span> <span class="p">:</span> <span class="o">.</span><span class="mi">38</span><span class="p">,</span>       <span class="c1"># chordwise location of maximum thickness</span>

</pre></div>
</div>
<p>Next we provide some information related to structures.
We provide the Young’s and shear moduli, as well as the allowable yield stress and density of the material being used (the wingbox model currently assumes that the material is isotropic).
Here we use include a safety factor of 1.5 in the allowable yield stress.
The <cite>strength_factor_for_upper_skin</cite> value can be used to adjust the yield strength of the upper skin relative to the lower skin.
For example, if we were using different alloys for the top and bottom skin (e.g., Al7075 vs Al2024) we would provide the allowable yield stress of the lower skin for <cite>yield</cite> and the ratio of the yield strengths of the upper skin to the lower skin for <cite>strength_factor_for_upper_skin</cite>.
The <cite>wing_weight_ratio</cite> number is used to estimate the weight of other components not modeled in the wingbox structure (e.g., overlaps, fasteners, etc.).
With the <cite>exact_failure_constraint</cite> set to <cite>False</cite>, we aggregate the stress constraints for the FEM elements into a single constraint using the  Kreisselmeier–Steinhauser function.
This helps reduce computational cost during optimization by replacing a large number of constraints (one for each stress combination for each element) with a single constraint.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
            <span class="c1"># Structural values are based on aluminum 7075</span>
            <span class="s1">&#39;E&#39;</span> <span class="p">:</span> <span class="mf">73.1e9</span><span class="p">,</span>              <span class="c1"># [Pa] Young&#39;s modulus</span>
            <span class="s1">&#39;G&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="mf">73.1e9</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="mf">1.33</span><span class="p">),</span>     <span class="c1"># [Pa] shear modulus (calculated using E and the Poisson&#39;s ratio here)</span>
            <span class="s1">&#39;yield&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="mf">420.e6</span> <span class="o">/</span> <span class="mf">1.5</span><span class="p">),</span>  <span class="c1"># [Pa] allowable yield stress</span>
            <span class="s1">&#39;mrho&#39;</span> <span class="p">:</span> <span class="mf">2.78e3</span><span class="p">,</span>           <span class="c1"># [kg/m^3] material density</span>
            <span class="s1">&#39;strength_factor_for_upper_skin&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="c1"># the yield stress is multiplied by this factor for the upper skin</span>

            <span class="s1">&#39;wing_weight_ratio&#39;</span> <span class="p">:</span> <span class="mf">1.25</span><span class="p">,</span>
            <span class="s1">&#39;exact_failure_constraint&#39;</span> <span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="c1"># if false, use KS function</span>

</pre></div>
</div>
<p>The next two options <cite>struct_weight_relief</cite> and <cite>distributed_fuel_weight</cite> are used to specify whether the user wants the loads from the weight of the wingbox structure and the weight of the fuel to be distributed on the wing structure to provide load relief.
The <cite>struct_weight_relief</cite> is for the loads from the weight of the structure (including the <cite>wing_weight_ratio</cite> factor).
The <cite>distributed_fuel_weight</cite> is for the loads from the weight of the fuel, which is assumed to be distributed across the entire wing (the fraction of the total fuel that each wingbox segment, corresponding to each finite element, holds is equal to the ratio of its enclosed volume to the total enclosed volume of all the wingbox segments).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
            <span class="s1">&#39;struct_weight_relief&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s1">&#39;distributed_fuel_weight&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>

</pre></div>
</div>
<p>Next, we specify the density of the fuel (used to compute fuel volume from fuel mass) and also specify how much fuel we are carrying as reserves.
This reserve fuel weight is added to the weight of the aircraft for performance calculations as well as computing the loads from the fuel on the wing when using the <cite>distributed_fuel_weight</cite> option.
With these two final options, we are done with the surface dictionary and add it to a list called surfaces (here we only have one surface, but in general we might have multiple).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
            <span class="s1">&#39;fuel_density&#39;</span> <span class="p">:</span> <span class="mf">803.</span><span class="p">,</span>      <span class="c1"># [kg/m^3] fuel density (only needed if the fuel-in-wing volume constraint is used)</span>
            <span class="s1">&#39;Wf_reserve&#39;</span> <span class="p">:</span><span class="mf">15000.</span><span class="p">,</span>       <span class="c1"># [kg] reserve fuel mass</span>

            <span class="p">}</span>

<span class="n">surfaces</span> <span class="o">=</span> <span class="p">[</span><span class="n">surf_dict</span><span class="p">]</span>

</pre></div>
</div>
<p>Next, we instantiate the OpenMDAO <cite>Problem</cite> and specify the independent variables.
We will use some of these variables later as design variables and some simply as inputs.
First we provide some inputs related to the flight conditions (Mach number, airspeed, Reynolds number per unit length, air density, and speed of sound).
Since we want to consider two flight points in this example (a nominal cruise case and a 2.5g maneuver case), we provide two values for each input that is different for the two cases.
For example, our cruise Mach number is 0.85 and our maneuver Mach number is 0.64.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># Create the problem and assign the model group</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">Problem</span><span class="p">()</span>

<span class="c1"># Add problem information as an independent variables component</span>
<span class="n">indep_var_comp</span> <span class="o">=</span> <span class="n">IndepVarComp</span><span class="p">()</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;Mach_number&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.64</span><span class="p">]))</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">.</span><span class="mi">85</span> <span class="o">*</span> <span class="mf">295.07</span><span class="p">,</span> <span class="o">.</span><span class="mi">64</span> <span class="o">*</span> <span class="mf">340.294</span><span class="p">]),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m/s&#39;</span><span class="p">)</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;re&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.348</span><span class="o">*</span><span class="mf">295.07</span><span class="o">*.</span><span class="mi">85</span><span class="o">*</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.43</span><span class="o">*</span><span class="mf">1e-5</span><span class="p">),</span> \
                          <span class="mf">1.225</span><span class="o">*</span><span class="mf">340.294</span><span class="o">*.</span><span class="mi">64</span><span class="o">*</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.81206</span><span class="o">*</span><span class="mf">1e-5</span><span class="p">)]),</span>  <span class="n">units</span><span class="o">=</span><span class="s1">&#39;1/m&#39;</span><span class="p">)</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;rho&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.348</span><span class="p">,</span> <span class="mf">1.225</span><span class="p">]),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;kg/m**3&#39;</span><span class="p">)</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;speed_of_sound&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">295.07</span><span class="p">,</span> <span class="mf">340.294</span><span class="p">]),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m/s&#39;</span><span class="p">)</span>

</pre></div>
</div>
<p>The following are some more independent variables.
We have the thrust-specific fuel consumption, <cite>CT</cite>, cruise range, <cite>R</cite>, and the weight of the aircraft without the fuel required for the cruise point and without the weight of the wing structure, <cite>W0</cite>.
Since we are not interested in the fuel burn or range at the maneuver point, we only provide a single value for these inputs that will be used for the cruise fuel burn.
Note that <cite>W0</cite> includes the reserve fuel weight, which is why it is added here.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;CT&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.53</span><span class="o">/</span><span class="mi">3600</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;1/s&#39;</span><span class="p">)</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">14.307e6</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;W0&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mi">148000</span> <span class="o">+</span> <span class="n">surf_dict</span><span class="p">[</span><span class="s1">&#39;Wf_reserve&#39;</span><span class="p">],</span>  <span class="n">units</span><span class="o">=</span><span class="s1">&#39;kg&#39;</span><span class="p">)</span>

</pre></div>
</div>
<p>Next, we specify the load factor for each flight point (1g for cruise and 2.5g for the maneuver case).
We also provide values for the angle of attack.
In this case, instead of providing two values as an array for one variable, we add two separate variables with different names (<cite>alpha</cite> and <cite>alpha_maneuver</cite>).
We create two variables just for convenience because, for this example, we allow the optimizer to trim the aircraft for the maneuver case using the angle of attack for that flight point (by making it a design variable), but keep the angle of attack fixed for the cruise case and make the optimizer trim the aircraft for the cruise flight point using the twist distribution.
We also include the empty center of gravity location here as a reminder that we could use it later for studies in which we include tail surfaces and consider pitching moments (not done in this example).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;load_factor&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">]))</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;alpha_maneuver&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>

<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;empty_cg&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">)),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>

</pre></div>
</div>
<p>Finally, we also add the fuel mass as an independent variable to use it as a design variable.
This may seem like a strange design variable to have, but we do this from an optimization architecture point of view.
Instead of directly transferring the fuel burn value from the cruise point to the maneuver point (used to calculate MTOW for the maneuver point), we instead create a constraint (shown later) and make the optimizer ensure that the value being used for the fuel mass is the same value that is computed in the cruise point.
This also allows the flexibility to later decide that you want to use a different value for the fuel mass for the maneuver case (or any other flight point you may have) that does not depend on the cruise point (or any other flight point you may have).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">10000.</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;kg&#39;</span><span class="p">)</span>

<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;prob_vars&#39;</span><span class="p">,</span>
     <span class="n">indep_var_comp</span><span class="p">,</span>
     <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>

</pre></div>
</div>
<p>Next, we instantiate aerostructual <cite>groups</cite> for each surface (only one in this example) and add them to the model.
We use a loop for generality but it is not necessary for this example because we only have one surface (just the wing).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># Loop over each surface in the surfaces list</span>
<span class="k">for</span> <span class="n">surface</span> <span class="ow">in</span> <span class="n">surfaces</span><span class="p">:</span>

    <span class="c1"># Get the surface name and create a group to contain components</span>
    <span class="c1"># only for this surface</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">surface</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

    <span class="n">aerostruct_group</span> <span class="o">=</span> <span class="n">AerostructGeometry</span><span class="p">(</span><span class="n">surface</span><span class="o">=</span><span class="n">surface</span><span class="p">)</span>

    <span class="c1"># Add groups to the problem with the name of the surface.</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">aerostruct_group</span><span class="p">)</span>

</pre></div>
</div>
<p>Now we have to instantiate aerostructural flight points (one for cruise and one for the maneuver case in this example), add them to the model, and after that connect the inputs to the points.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># Loop through and add a certain number of aerostruct points</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>

    <span class="n">point_name</span> <span class="o">=</span> <span class="s1">&#39;AS_point_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="c1"># Connect the parameters within the model for each aero point</span>

    <span class="c1"># Create the aerostruct point group and add it to the model</span>
    <span class="n">AS_point</span> <span class="o">=</span> <span class="n">AerostructPoint</span><span class="p">(</span><span class="n">surfaces</span><span class="o">=</span><span class="n">surfaces</span><span class="p">,</span> <span class="n">internally_connect_fuelburn</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="n">point_name</span><span class="p">,</span> <span class="n">AS_point</span><span class="p">)</span>

</pre></div>
</div>
<p>Here we make connect the inputs to the flight points.
For the inputs that have different values for each flight point, we also specify the <cite>src_indices</cite> to specify which one of the input values to use.
In some connections you may notice slightly different naming.
For example, for the air density we write <cite>‘rho’, point_name + ‘.rho’</cite>, but for the fuel mass we write <cite>‘fuel_mass’, point_name + ‘.total_perf.L_equals_W.fuelburn’</cite>.
This has to do with how the variables belonging to different components and groups have been promoted (i.e., which level in the hierarchy they are available at).
If you are unsure about where variables have been promoted to, while making connections on your own later, use OpenMDAO’s feature for visualizing the N2 diagram (commands shown later).
Hovering over variables in this diagram should tell you what names to use for them.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
    <span class="c1"># Connect flow properties to the analysis point</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.v&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;Mach_number&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.Mach_number&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;re&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.re&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;rho&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.rho&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;CT&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.CT&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.R&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;W0&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.W0&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;speed_of_sound&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.speed_of_sound&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;empty_cg&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.empty_cg&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;load_factor&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.load_factor&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.total_perf.L_equals_W.fuelburn&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.total_perf.CG.fuelburn&#39;</span><span class="p">)</span>

</pre></div>
</div>
<p>Now we have to make a few more internal connections that are not made automatically.
Once again, if you are unsure about whether variables have been connected correctly, use OpenMDAO’s N2 diagram visualization feature (commands shown later).
That diagram should show the connections, and the variables that have not been connected will be highlighted in red.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
    <span class="k">for</span> <span class="n">surface</span> <span class="ow">in</span> <span class="n">surfaces</span><span class="p">:</span>

        <span class="n">name</span> <span class="o">=</span> <span class="n">surface</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">surf_dict</span><span class="p">[</span><span class="s1">&#39;distributed_fuel_weight&#39;</span><span class="p">]:</span>
            <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;load_factor&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.coupled.load_factor&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">com_name</span> <span class="o">=</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_perf.&#39;</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.local_stiff_transformed&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.coupled.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.local_stiff_transformed&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.nodes&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.coupled.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.nodes&#39;</span><span class="p">)</span>

        <span class="c1"># Connect aerodyamic mesh to coupled group mesh</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.mesh&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.coupled.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.mesh&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">surf_dict</span><span class="p">[</span><span class="s1">&#39;struct_weight_relief&#39;</span><span class="p">]:</span>
            <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.element_mass&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.coupled.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.element_mass&#39;</span><span class="p">)</span>

        <span class="c1"># Connect performance calculation variables</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.nodes&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;nodes&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.cg_location&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="s1">&#39;total_perf.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_cg_location&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.structural_mass&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="s1">&#39;total_perf.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_structural_mass&#39;</span><span class="p">)</span>

        <span class="c1"># Connect wingbox properties to von Mises stress calcs</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.Qz&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;Qz&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.J&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;J&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.A_enc&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;A_enc&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.htop&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;htop&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.hbottom&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;hbottom&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.hfront&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;hfront&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.hrear&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;hrear&#39;</span><span class="p">)</span>

        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.spar_thickness&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;spar_thickness&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.t_over_c&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;t_over_c&#39;</span><span class="p">)</span>


</pre></div>
</div>
<p>We have a couple more connections to make outside the loop because of the variable naming.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_0&#39;</span> <span class="o">+</span> <span class="s1">&#39;.alpha&#39;</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;alpha_maneuver&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_1&#39;</span> <span class="o">+</span> <span class="s1">&#39;.alpha&#39;</span><span class="p">)</span>

</pre></div>
</div>
<p>For this example, we are also interested in adding a fuel-volume constraint that makes sure that the wingbox has enough internal volume to store the required fuel mass (estimated from the cruise flight point plus the reserve fuel).
First we instantiate and add the component that computes the difference between the available internal volume and the required fuel volume (<cite>WingboxFuelVolDelta</cite>).
Then we make some connections.
We connect the fuel burn computed from the cruise condition to this component because we are interested in the fuel burn value from the cruise condition.
We also have an <cite>if</cite> statement to make some more connections if we want the loads from the weight of the fuel to be applied to the FEM model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># Here we add the fuel volume constraint componenet to the model</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;fuel_vol_delta&#39;</span><span class="p">,</span> <span class="n">WingboxFuelVolDelta</span><span class="p">(</span><span class="n">surface</span><span class="o">=</span><span class="n">surface</span><span class="p">))</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;wing.struct_setup.fuel_vols&#39;</span><span class="p">,</span> <span class="s1">&#39;fuel_vol_delta.fuel_vols&#39;</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;AS_point_0.fuelburn&#39;</span><span class="p">,</span> <span class="s1">&#39;fuel_vol_delta.fuelburn&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">surf_dict</span><span class="p">[</span><span class="s1">&#39;distributed_fuel_weight&#39;</span><span class="p">]:</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;wing.struct_setup.fuel_vols&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_0.coupled.wing.struct_states.fuel_vols&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_0.coupled.wing.struct_states.fuel_mass&#39;</span><span class="p">)</span>

    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;wing.struct_setup.fuel_vols&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_1.coupled.wing.struct_states.fuel_vols&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_1.coupled.wing.struct_states.fuel_mass&#39;</span><span class="p">)</span>

</pre></div>
</div>
<p>Next, we use OpenMDAO’s ExecComp feature (which can be used to quickly create simple components) to create a component that is used later for the constraint that ensures that the fuel mass value (used to compute the aircraft weight and fuel loads) is the same as the fuel burn mass computed from the cruise point (i.e., AS_point_0 here).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">comp</span> <span class="o">=</span> <span class="n">ExecComp</span><span class="p">(</span><span class="s1">&#39;fuel_diff = (fuel_mass - fuelburn) / fuelburn&#39;</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;fuel_diff&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span>
    <span class="n">promotes_inputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">],</span>
    <span class="n">promotes_outputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fuel_diff&#39;</span><span class="p">])</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;AS_point_0.fuelburn&#39;</span><span class="p">,</span> <span class="s1">&#39;fuel_diff.fuelburn&#39;</span><span class="p">)</span>

</pre></div>
</div>
<p>Now it is time to specify the objective function and design variables.
For this example, the objective function is the fuel burn computed using the cruise point (AS_point_0).
The design variables are the control points for the twist, spar thickness, skin thickness, and thickness-to-chord ratio distributions.
We add these design variables along with upper and lower bounds, and scalers.
The scalers are used to scale the values of the design variables to help the optimizer converge better.
Usually a scaler that brings the design variable to an order of magnitude around 1 is recommended.
We also have a design variable for the maneuver angle of attack.
In this example, the cruise angle of attack (which rotates the entire wing) is fixed at 0 and the optimizer uses the twist distribution to trim the aircraft for cruise.
Then using this same twist distribution, the maneuver case is trimmed using the maneuver angle of attack design variable.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s1">&#39;AS_point_0.fuelburn&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>

<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;wing.twist_cp&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=-</span><span class="mf">15.</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">15.</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;wing.spar_thickness_cp&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="mf">1e2</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;wing.skin_thickness_cp&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="mf">1e2</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;wing.geometry.t_over_c_cp&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.07</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;alpha_maneuver&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=-</span><span class="mf">15.</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

</pre></div>
</div>
<p>Next we add some constraints.
For the cruise point, we specify a nominal coefficient of lift of 0.5.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;AS_point_0.CL&#39;</span><span class="p">,</span> <span class="n">equals</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

</pre></div>
</div>
<p>For the maneuver point, we use the following constraints to ensure that the lift equals the weight, and that the stresses in the structure do not exceed the specified allowable value.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;AS_point_1.L_equals_W&#39;</span><span class="p">,</span> <span class="n">equals</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;AS_point_1.wing_perf.failure&#39;</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>

</pre></div>
</div>
<p>For this example, we also add a constraint that ensures that the wingbox has enough internal volume for the fuel.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;fuel_vol_delta.fuel_vol_delta&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>

</pre></div>
</div>
<p>Now we add <cite>fuel_mass</cite> as a design variable and add the consistency constraint that ensures that the fuel mass value is the same as the fuel burn mass computed from the cruise point.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">2e5</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;fuel_diff&#39;</span><span class="p">,</span> <span class="n">equals</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>

</pre></div>
</div>
<p>Next, we specify an optimizer and its tolerance.
Here we use the easily available SLSQP optimizer from SciPy and specify a very low tolerance to keep the computational cost very low for the purposes of this example.
We recommend that the user experiments with tolerances and uses much tighter tolerances for their studies.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">ScipyOptimizeDriver</span><span class="p">()</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;optimizer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SLSQP&#39;</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;tol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-2</span>

</pre></div>
</div>
<p>We also include the following recorder settings so that OpenMDAO stores the optimization history in a database that can be used with the plot_wingbox.py visualization script in the <cite>utils</cite> sub-directory.
It isn’t necessary to specify the long list of variables (<cite>prob.driver.recording_options[‘includes’]</cite>), and instead we could just use <cite>prob.driver.recording_options[‘includes’] = [‘*’]</cite> to include all variables.
However, for finer meshes, the database becomes extremely large and the visualization script does not work due to memory requirements.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">recorder</span> <span class="o">=</span> <span class="n">SqliteRecorder</span><span class="p">(</span><span class="s2">&quot;aerostruct.db&quot;</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_recorder</span><span class="p">(</span><span class="n">recorder</span><span class="p">)</span>

<span class="c1"># We could also just use prob.driver.recording_options[&#39;includes&#39;]=[&#39;*&#39;] here, but for large meshes the database file becomes extremely large. So we just select the variables we need.</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">recording_options</span><span class="p">[</span><span class="s1">&#39;includes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;rho&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;cg&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_1.cg&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_0.cg&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_0.coupled.wing_loads.loads&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_1.coupled.wing_loads.loads&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_0.coupled.wing.normals&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_1.coupled.wing.normals&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_0.coupled.wing.widths&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_1.coupled.wing.widths&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_0.coupled.aero_states.wing_sec_forces&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_1.coupled.aero_states.wing_sec_forces&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_0.wing_perf.CL1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_1.wing_perf.CL1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_0.coupled.wing.S_ref&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_1.coupled.wing.S_ref&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wing.geometry.twist&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wing.mesh&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wing.skin_thickness&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wing.spar_thickness&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wing.t_over_c&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wing.structural_mass&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_0.wing_perf.vonmises&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_1.wing_perf.vonmises&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_0.coupled.wing.def_mesh&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_1.coupled.wing.def_mesh&#39;</span><span class="p">,</span>
    <span class="p">]</span>

<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">recording_options</span><span class="p">[</span><span class="s1">&#39;record_objectives&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">recording_options</span><span class="p">[</span><span class="s1">&#39;record_constraints&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">recording_options</span><span class="p">[</span><span class="s1">&#39;record_desvars&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">recording_options</span><span class="p">[</span><span class="s1">&#39;record_inputs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

</pre></div>
</div>
<p>Finally, we call the usual commands to setup and run the optimization problem.
Notice that we also have some commands commented out.
The <cite>view_model</cite> command can be used to generate a .html script that can be opened with a web browser to visualize the N2 problem structure.
The <cite>check_partials</cite> command can be used to check partial derivatives when modifying or creating components.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># Set up the problem</span>
<span class="n">prob</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>

<span class="c1"># from openmdao.api import view_model</span>
<span class="c1"># view_model(prob)</span>

<span class="c1"># prob.check_partials(form=&#39;central&#39;, compact_print=True)</span>

<span class="n">prob</span><span class="o">.</span><span class="n">run_driver</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The fuel burn value is&#39;</span><span class="p">,</span> <span class="n">prob</span><span class="p">[</span><span class="s1">&#39;AS_point_0.fuelburn&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;[kg]&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The wingbox mass (excluding the wing_weight_ratio) is&#39;</span><span class="p">,</span> <span class="n">prob</span><span class="p">[</span><span class="s1">&#39;wing.structural_mass&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">surf_dict</span><span class="p">[</span><span class="s1">&#39;wing_weight_ratio&#39;</span><span class="p">],</span> <span class="s1">&#39;[kg]&#39;</span><span class="p">)</span>

</pre></div>
</div>
<p>Now we put the code together, run it, and see the output:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>

<span class="c1"># Ignore the #docs checkpoint comments. They are just used to split up the code for the documentation webpage.</span>
<span class="c1">#docs checkpoint 0</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">openaerostruct.geometry.utils</span> <span class="kn">import</span> <span class="n">generate_mesh</span>
<span class="kn">from</span> <span class="nn">openaerostruct.integration.aerostruct_groups</span> <span class="kn">import</span> <span class="n">AerostructGeometry</span><span class="p">,</span> <span class="n">AerostructPoint</span>
<span class="kn">from</span> <span class="nn">openmdao.api</span> <span class="kn">import</span> <span class="n">IndepVarComp</span><span class="p">,</span> <span class="n">Problem</span><span class="p">,</span> <span class="n">ScipyOptimizeDriver</span><span class="p">,</span> <span class="n">SqliteRecorder</span><span class="p">,</span> <span class="n">ExecComp</span>
<span class="kn">from</span> <span class="nn">openaerostruct.structures.wingbox_fuel_vol_delta</span> <span class="kn">import</span> <span class="n">WingboxFuelVolDelta</span>
<span class="kn">from</span> <span class="nn">openaerostruct.utils.constants</span> <span class="kn">import</span> <span class="n">grav_constant</span>

<span class="c1">#docs checkpoint 1</span>

<span class="c1"># Provide coordinates for a portion of an airfoil for the wingbox cross-section as an nparray with dtype=complex (to work with the complex-step approximation for derivatives).</span>
<span class="c1"># These should be for an airfoil with the chord scaled to 1.</span>
<span class="c1"># We use the 10% to 60% portion of the NASA SC2-0612 airfoil for this case</span>
<span class="c1"># We use the coordinates available from airfoiltools.com. Using such a large number of coordinates is not necessary.</span>
<span class="c1"># The first and last x-coordinates of the upper and lower surfaces must be the same</span>

<span class="n">upper_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">0.14</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.18</span><span class="p">,</span> <span class="mf">0.19</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.21</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">,</span> <span class="mf">0.23</span><span class="p">,</span> <span class="mf">0.24</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.26</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.29</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.31</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.36</span><span class="p">,</span> <span class="mf">0.37</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.41</span><span class="p">,</span> <span class="mf">0.42</span><span class="p">,</span> <span class="mf">0.43</span><span class="p">,</span> <span class="mf">0.44</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.48</span><span class="p">,</span> <span class="mf">0.49</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.51</span><span class="p">,</span> <span class="mf">0.52</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">,</span> <span class="mf">0.54</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.56</span><span class="p">,</span> <span class="mf">0.57</span><span class="p">,</span> <span class="mf">0.58</span><span class="p">,</span> <span class="mf">0.59</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;complex128&#39;</span><span class="p">)</span>
<span class="n">lower_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">0.14</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.18</span><span class="p">,</span> <span class="mf">0.19</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.21</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">,</span> <span class="mf">0.23</span><span class="p">,</span> <span class="mf">0.24</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.26</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.29</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.31</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.36</span><span class="p">,</span> <span class="mf">0.37</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.41</span><span class="p">,</span> <span class="mf">0.42</span><span class="p">,</span> <span class="mf">0.43</span><span class="p">,</span> <span class="mf">0.44</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.48</span><span class="p">,</span> <span class="mf">0.49</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.51</span><span class="p">,</span> <span class="mf">0.52</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">,</span> <span class="mf">0.54</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.56</span><span class="p">,</span> <span class="mf">0.57</span><span class="p">,</span> <span class="mf">0.58</span><span class="p">,</span> <span class="mf">0.59</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;complex128&#39;</span><span class="p">)</span>
<span class="n">upper_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.0447</span><span class="p">,</span>  <span class="mf">0.046</span><span class="p">,</span>  <span class="mf">0.0472</span><span class="p">,</span>  <span class="mf">0.0484</span><span class="p">,</span>  <span class="mf">0.0495</span><span class="p">,</span>  <span class="mf">0.0505</span><span class="p">,</span>  <span class="mf">0.0514</span><span class="p">,</span>  <span class="mf">0.0523</span><span class="p">,</span>  <span class="mf">0.0531</span><span class="p">,</span>  <span class="mf">0.0538</span><span class="p">,</span> <span class="mf">0.0545</span><span class="p">,</span>  <span class="mf">0.0551</span><span class="p">,</span>  <span class="mf">0.0557</span><span class="p">,</span> <span class="mf">0.0563</span><span class="p">,</span>  <span class="mf">0.0568</span><span class="p">,</span> <span class="mf">0.0573</span><span class="p">,</span>  <span class="mf">0.0577</span><span class="p">,</span>  <span class="mf">0.0581</span><span class="p">,</span>  <span class="mf">0.0585</span><span class="p">,</span>  <span class="mf">0.0588</span><span class="p">,</span>  <span class="mf">0.0591</span><span class="p">,</span>  <span class="mf">0.0593</span><span class="p">,</span>  <span class="mf">0.0595</span><span class="p">,</span>  <span class="mf">0.0597</span><span class="p">,</span>  <span class="mf">0.0599</span><span class="p">,</span>  <span class="mf">0.06</span><span class="p">,</span>    <span class="mf">0.0601</span><span class="p">,</span>  <span class="mf">0.0602</span><span class="p">,</span>  <span class="mf">0.0602</span><span class="p">,</span>  <span class="mf">0.0602</span><span class="p">,</span>  <span class="mf">0.0602</span><span class="p">,</span>  <span class="mf">0.0602</span><span class="p">,</span>  <span class="mf">0.0601</span><span class="p">,</span>  <span class="mf">0.06</span><span class="p">,</span>    <span class="mf">0.0599</span><span class="p">,</span>  <span class="mf">0.0598</span><span class="p">,</span>  <span class="mf">0.0596</span><span class="p">,</span>  <span class="mf">0.0594</span><span class="p">,</span>  <span class="mf">0.0592</span><span class="p">,</span>  <span class="mf">0.0589</span><span class="p">,</span>  <span class="mf">0.0586</span><span class="p">,</span>  <span class="mf">0.0583</span><span class="p">,</span>  <span class="mf">0.058</span><span class="p">,</span>   <span class="mf">0.0576</span><span class="p">,</span>  <span class="mf">0.0572</span><span class="p">,</span>  <span class="mf">0.0568</span><span class="p">,</span>  <span class="mf">0.0563</span><span class="p">,</span>  <span class="mf">0.0558</span><span class="p">,</span>  <span class="mf">0.0553</span><span class="p">,</span>  <span class="mf">0.0547</span><span class="p">,</span>  <span class="mf">0.0541</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;complex128&#39;</span><span class="p">)</span>
<span class="n">lower_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.0447</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.046</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0473</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0485</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0496</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0506</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0515</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0524</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0532</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.054</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0547</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0554</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.056</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0565</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.057</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0575</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0579</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0583</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0586</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0589</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0592</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0594</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0595</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0596</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0597</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0598</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0598</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0598</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0598</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0597</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0596</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0594</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0592</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0589</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0586</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0582</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0578</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0573</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0567</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0561</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0554</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0546</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0538</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0529</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0519</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0509</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0497</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0485</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0472</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0458</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0444</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;complex128&#39;</span><span class="p">)</span>

<span class="c1">#docs checkpoint 2</span>

<span class="c1"># Create a dictionary to store options about the surface</span>
<span class="n">mesh_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;num_y&#39;</span> <span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
             <span class="s1">&#39;num_x&#39;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
             <span class="s1">&#39;wing_type&#39;</span> <span class="p">:</span> <span class="s1">&#39;uCRM_based&#39;</span><span class="p">,</span>
             <span class="s1">&#39;symmetry&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
             <span class="s1">&#39;chord_cos_spacing&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
             <span class="s1">&#39;span_cos_spacing&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
             <span class="s1">&#39;num_twist_cp&#39;</span> <span class="p">:</span> <span class="mi">4</span>
             <span class="p">}</span>

<span class="n">mesh</span><span class="p">,</span> <span class="n">twist_cp</span> <span class="o">=</span> <span class="n">generate_mesh</span><span class="p">(</span><span class="n">mesh_dict</span><span class="p">)</span>

<span class="c1">#docs checkpoint 3</span>

<span class="n">surf_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># Wing definition</span>
            <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;wing&#39;</span><span class="p">,</span>         <span class="c1"># give the surface some name</span>
            <span class="s1">&#39;symmetry&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>       <span class="c1"># if True, model only one half of the lifting surface</span>
            <span class="s1">&#39;S_ref_type&#39;</span> <span class="p">:</span> <span class="s1">&#39;projected&#39;</span><span class="p">,</span> <span class="c1"># how we compute the wing area,</span>
                                     <span class="c1"># can be &#39;wetted&#39; or &#39;projected&#39;</span>
            <span class="s1">&#39;mesh&#39;</span> <span class="p">:</span> <span class="n">mesh</span><span class="p">,</span>

            <span class="s1">&#39;fem_model_type&#39;</span> <span class="p">:</span> <span class="s1">&#39;wingbox&#39;</span><span class="p">,</span> <span class="c1"># &#39;wingbox&#39; or &#39;tube&#39;</span>
            <span class="s1">&#39;data_x_upper&#39;</span> <span class="p">:</span> <span class="n">upper_x</span><span class="p">,</span>
            <span class="s1">&#39;data_x_lower&#39;</span> <span class="p">:</span> <span class="n">lower_x</span><span class="p">,</span>
            <span class="s1">&#39;data_y_upper&#39;</span> <span class="p">:</span> <span class="n">upper_y</span><span class="p">,</span>
            <span class="s1">&#39;data_y_lower&#39;</span> <span class="p">:</span> <span class="n">lower_y</span><span class="p">,</span>

            <span class="c1">#docs checkpoint 4</span>

            <span class="s1">&#39;twist_cp&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">,</span> <span class="mf">9.</span><span class="p">]),</span> <span class="c1"># [deg]</span>

            <span class="s1">&#39;spar_thickness_cp&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.004</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.008</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]),</span> <span class="c1"># [m]</span>
            <span class="s1">&#39;skin_thickness_cp&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.015</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">]),</span> <span class="c1"># [m]</span>

            <span class="s1">&#39;t_over_c_cp&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">]),</span>
            <span class="s1">&#39;original_wingbox_airfoil_t_over_c&#39;</span> <span class="p">:</span> <span class="mf">0.12</span><span class="p">,</span>

            <span class="c1">#docs checkpoint 5</span>

            <span class="c1"># Aerodynamic deltas.</span>
            <span class="c1"># These CL0 and CD0 values are added to the CL and CD</span>
            <span class="c1"># obtained from aerodynamic analysis of the surface to get</span>
            <span class="c1"># the total CL and CD.</span>
            <span class="c1"># These CL0 and CD0 values do not vary wrt alpha.</span>
            <span class="c1"># They can be used to account for things that are not included, such as contributions from the fuselage, camber, etc.</span>
            <span class="s1">&#39;CL0&#39;</span> <span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>            <span class="c1"># CL delta</span>
            <span class="s1">&#39;CD0&#39;</span> <span class="p">:</span> <span class="mf">0.0078</span><span class="p">,</span>         <span class="c1"># CD delta</span>

            <span class="s1">&#39;with_viscous&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>  <span class="c1"># if true, compute viscous drag</span>
            <span class="s1">&#39;with_wave&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>     <span class="c1"># if true, compute wave drag</span>

            <span class="c1"># Airfoil properties for viscous drag calculation</span>
            <span class="s1">&#39;k_lam&#39;</span> <span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>         <span class="c1"># fraction of chord with laminar</span>
                                    <span class="c1"># flow, used for viscous drag</span>
            <span class="s1">&#39;c_max_t&#39;</span> <span class="p">:</span> <span class="o">.</span><span class="mi">38</span><span class="p">,</span>       <span class="c1"># chordwise location of maximum thickness</span>

            <span class="c1">#docs checkpoint 6</span>

            <span class="c1"># Structural values are based on aluminum 7075</span>
            <span class="s1">&#39;E&#39;</span> <span class="p">:</span> <span class="mf">73.1e9</span><span class="p">,</span>              <span class="c1"># [Pa] Young&#39;s modulus</span>
            <span class="s1">&#39;G&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="mf">73.1e9</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="mf">1.33</span><span class="p">),</span>     <span class="c1"># [Pa] shear modulus (calculated using E and the Poisson&#39;s ratio here)</span>
            <span class="s1">&#39;yield&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="mf">420.e6</span> <span class="o">/</span> <span class="mf">1.5</span><span class="p">),</span>  <span class="c1"># [Pa] allowable yield stress</span>
            <span class="s1">&#39;mrho&#39;</span> <span class="p">:</span> <span class="mf">2.78e3</span><span class="p">,</span>           <span class="c1"># [kg/m^3] material density</span>
            <span class="s1">&#39;strength_factor_for_upper_skin&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="c1"># the yield stress is multiplied by this factor for the upper skin</span>

            <span class="s1">&#39;wing_weight_ratio&#39;</span> <span class="p">:</span> <span class="mf">1.25</span><span class="p">,</span>
            <span class="s1">&#39;exact_failure_constraint&#39;</span> <span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="c1"># if false, use KS function</span>

            <span class="c1">#docs checkpoint 7</span>

            <span class="s1">&#39;struct_weight_relief&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
            <span class="s1">&#39;distributed_fuel_weight&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>

            <span class="c1">#docs checkpoint 8</span>

            <span class="s1">&#39;fuel_density&#39;</span> <span class="p">:</span> <span class="mf">803.</span><span class="p">,</span>      <span class="c1"># [kg/m^3] fuel density (only needed if the fuel-in-wing volume constraint is used)</span>
            <span class="s1">&#39;Wf_reserve&#39;</span> <span class="p">:</span><span class="mf">15000.</span><span class="p">,</span>       <span class="c1"># [kg] reserve fuel mass</span>

            <span class="p">}</span>

<span class="n">surfaces</span> <span class="o">=</span> <span class="p">[</span><span class="n">surf_dict</span><span class="p">]</span>

<span class="c1">#docs checkpoint 9</span>

<span class="c1"># Create the problem and assign the model group</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">Problem</span><span class="p">()</span>

<span class="c1"># Add problem information as an independent variables component</span>
<span class="n">indep_var_comp</span> <span class="o">=</span> <span class="n">IndepVarComp</span><span class="p">()</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;Mach_number&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.64</span><span class="p">]))</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">.</span><span class="mi">85</span> <span class="o">*</span> <span class="mf">295.07</span><span class="p">,</span> <span class="o">.</span><span class="mi">64</span> <span class="o">*</span> <span class="mf">340.294</span><span class="p">]),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m/s&#39;</span><span class="p">)</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;re&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.348</span><span class="o">*</span><span class="mf">295.07</span><span class="o">*.</span><span class="mi">85</span><span class="o">*</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.43</span><span class="o">*</span><span class="mf">1e-5</span><span class="p">),</span> \
                          <span class="mf">1.225</span><span class="o">*</span><span class="mf">340.294</span><span class="o">*.</span><span class="mi">64</span><span class="o">*</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.81206</span><span class="o">*</span><span class="mf">1e-5</span><span class="p">)]),</span>  <span class="n">units</span><span class="o">=</span><span class="s1">&#39;1/m&#39;</span><span class="p">)</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;rho&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.348</span><span class="p">,</span> <span class="mf">1.225</span><span class="p">]),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;kg/m**3&#39;</span><span class="p">)</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;speed_of_sound&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">295.07</span><span class="p">,</span> <span class="mf">340.294</span><span class="p">]),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m/s&#39;</span><span class="p">)</span>

<span class="c1">#docs checkpoint 10</span>

<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;CT&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.53</span><span class="o">/</span><span class="mi">3600</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;1/s&#39;</span><span class="p">)</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">14.307e6</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;W0&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mi">148000</span> <span class="o">+</span> <span class="n">surf_dict</span><span class="p">[</span><span class="s1">&#39;Wf_reserve&#39;</span><span class="p">],</span>  <span class="n">units</span><span class="o">=</span><span class="s1">&#39;kg&#39;</span><span class="p">)</span>

<span class="c1">#docs checkpoint 11</span>

<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;load_factor&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">]))</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;alpha_maneuver&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>

<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;empty_cg&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">)),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>

<span class="c1">#docs checkpoint 12</span>

<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">10000.</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;kg&#39;</span><span class="p">)</span>

<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;prob_vars&#39;</span><span class="p">,</span>
     <span class="n">indep_var_comp</span><span class="p">,</span>
     <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>

<span class="c1">#docs checkpoint 13</span>

<span class="c1"># Loop over each surface in the surfaces list</span>
<span class="k">for</span> <span class="n">surface</span> <span class="ow">in</span> <span class="n">surfaces</span><span class="p">:</span>

    <span class="c1"># Get the surface name and create a group to contain components</span>
    <span class="c1"># only for this surface</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">surface</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

    <span class="n">aerostruct_group</span> <span class="o">=</span> <span class="n">AerostructGeometry</span><span class="p">(</span><span class="n">surface</span><span class="o">=</span><span class="n">surface</span><span class="p">)</span>

    <span class="c1"># Add groups to the problem with the name of the surface.</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">aerostruct_group</span><span class="p">)</span>

<span class="c1">#docs checkpoint 14</span>

<span class="c1"># Loop through and add a certain number of aerostruct points</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>

    <span class="n">point_name</span> <span class="o">=</span> <span class="s1">&#39;AS_point_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="c1"># Connect the parameters within the model for each aero point</span>

    <span class="c1"># Create the aerostruct point group and add it to the model</span>
    <span class="n">AS_point</span> <span class="o">=</span> <span class="n">AerostructPoint</span><span class="p">(</span><span class="n">surfaces</span><span class="o">=</span><span class="n">surfaces</span><span class="p">,</span> <span class="n">internally_connect_fuelburn</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="n">point_name</span><span class="p">,</span> <span class="n">AS_point</span><span class="p">)</span>

    <span class="c1">#docs checkpoint 15</span>

    <span class="c1"># Connect flow properties to the analysis point</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.v&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;Mach_number&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.Mach_number&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;re&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.re&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;rho&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.rho&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;CT&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.CT&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.R&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;W0&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.W0&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;speed_of_sound&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.speed_of_sound&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;empty_cg&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.empty_cg&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;load_factor&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.load_factor&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.total_perf.L_equals_W.fuelburn&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.total_perf.CG.fuelburn&#39;</span><span class="p">)</span>

    <span class="c1">#docs checkpoint 16</span>

    <span class="k">for</span> <span class="n">surface</span> <span class="ow">in</span> <span class="n">surfaces</span><span class="p">:</span>

        <span class="n">name</span> <span class="o">=</span> <span class="n">surface</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">surf_dict</span><span class="p">[</span><span class="s1">&#39;distributed_fuel_weight&#39;</span><span class="p">]:</span>
            <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;load_factor&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.coupled.load_factor&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">com_name</span> <span class="o">=</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_perf.&#39;</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.local_stiff_transformed&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.coupled.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.local_stiff_transformed&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.nodes&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.coupled.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.nodes&#39;</span><span class="p">)</span>

        <span class="c1"># Connect aerodyamic mesh to coupled group mesh</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.mesh&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.coupled.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.mesh&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">surf_dict</span><span class="p">[</span><span class="s1">&#39;struct_weight_relief&#39;</span><span class="p">]:</span>
            <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.element_mass&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.coupled.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.element_mass&#39;</span><span class="p">)</span>

        <span class="c1"># Connect performance calculation variables</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.nodes&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;nodes&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.cg_location&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="s1">&#39;total_perf.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_cg_location&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.structural_mass&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="s1">&#39;total_perf.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_structural_mass&#39;</span><span class="p">)</span>

        <span class="c1"># Connect wingbox properties to von Mises stress calcs</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.Qz&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;Qz&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.J&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;J&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.A_enc&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;A_enc&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.htop&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;htop&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.hbottom&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;hbottom&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.hfront&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;hfront&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.hrear&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;hrear&#39;</span><span class="p">)</span>

        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.spar_thickness&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;spar_thickness&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.t_over_c&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;t_over_c&#39;</span><span class="p">)</span>


<span class="c1">#docs checkpoint 17</span>

<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_0&#39;</span> <span class="o">+</span> <span class="s1">&#39;.alpha&#39;</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;alpha_maneuver&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_1&#39;</span> <span class="o">+</span> <span class="s1">&#39;.alpha&#39;</span><span class="p">)</span>

<span class="c1">#docs checkpoint 18</span>

<span class="c1"># Here we add the fuel volume constraint componenet to the model</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;fuel_vol_delta&#39;</span><span class="p">,</span> <span class="n">WingboxFuelVolDelta</span><span class="p">(</span><span class="n">surface</span><span class="o">=</span><span class="n">surface</span><span class="p">))</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;wing.struct_setup.fuel_vols&#39;</span><span class="p">,</span> <span class="s1">&#39;fuel_vol_delta.fuel_vols&#39;</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;AS_point_0.fuelburn&#39;</span><span class="p">,</span> <span class="s1">&#39;fuel_vol_delta.fuelburn&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">surf_dict</span><span class="p">[</span><span class="s1">&#39;distributed_fuel_weight&#39;</span><span class="p">]:</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;wing.struct_setup.fuel_vols&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_0.coupled.wing.struct_states.fuel_vols&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_0.coupled.wing.struct_states.fuel_mass&#39;</span><span class="p">)</span>

    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;wing.struct_setup.fuel_vols&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_1.coupled.wing.struct_states.fuel_vols&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_1.coupled.wing.struct_states.fuel_mass&#39;</span><span class="p">)</span>

<span class="c1">#docs checkpoint 19</span>

<span class="n">comp</span> <span class="o">=</span> <span class="n">ExecComp</span><span class="p">(</span><span class="s1">&#39;fuel_diff = (fuel_mass - fuelburn) / fuelburn&#39;</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;fuel_diff&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span>
    <span class="n">promotes_inputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">],</span>
    <span class="n">promotes_outputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fuel_diff&#39;</span><span class="p">])</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;AS_point_0.fuelburn&#39;</span><span class="p">,</span> <span class="s1">&#39;fuel_diff.fuelburn&#39;</span><span class="p">)</span>

<span class="c1">#docs checkpoint 20</span>

<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s1">&#39;AS_point_0.fuelburn&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>

<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;wing.twist_cp&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=-</span><span class="mf">15.</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">15.</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;wing.spar_thickness_cp&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="mf">1e2</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;wing.skin_thickness_cp&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="mf">1e2</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;wing.geometry.t_over_c_cp&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.07</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;alpha_maneuver&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=-</span><span class="mf">15.</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="c1">#docs checkpoint 21</span>

<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;AS_point_0.CL&#39;</span><span class="p">,</span> <span class="n">equals</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1">#docs checkpoint 22</span>

<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;AS_point_1.L_equals_W&#39;</span><span class="p">,</span> <span class="n">equals</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;AS_point_1.wing_perf.failure&#39;</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>

<span class="c1">#docs checkpoint 23</span>

<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;fuel_vol_delta.fuel_vol_delta&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>

<span class="c1">#docs checkpoint 24</span>

<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">2e5</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;fuel_diff&#39;</span><span class="p">,</span> <span class="n">equals</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>

<span class="c1">#docs checkpoint 25</span>

<span class="n">prob</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">ScipyOptimizeDriver</span><span class="p">()</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;optimizer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SLSQP&#39;</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;tol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-2</span>

<span class="c1">#docs checkpoint 26</span>

<span class="n">recorder</span> <span class="o">=</span> <span class="n">SqliteRecorder</span><span class="p">(</span><span class="s2">&quot;aerostruct.db&quot;</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_recorder</span><span class="p">(</span><span class="n">recorder</span><span class="p">)</span>

<span class="c1"># We could also just use prob.driver.recording_options[&#39;includes&#39;]=[&#39;*&#39;] here, but for large meshes the database file becomes extremely large. So we just select the variables we need.</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">recording_options</span><span class="p">[</span><span class="s1">&#39;includes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;rho&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;cg&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_1.cg&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_0.cg&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_0.coupled.wing_loads.loads&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_1.coupled.wing_loads.loads&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_0.coupled.wing.normals&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_1.coupled.wing.normals&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_0.coupled.wing.widths&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_1.coupled.wing.widths&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_0.coupled.aero_states.wing_sec_forces&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_1.coupled.aero_states.wing_sec_forces&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_0.wing_perf.CL1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_1.wing_perf.CL1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_0.coupled.wing.S_ref&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_1.coupled.wing.S_ref&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wing.geometry.twist&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wing.mesh&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wing.skin_thickness&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wing.spar_thickness&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wing.t_over_c&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wing.structural_mass&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_0.wing_perf.vonmises&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_1.wing_perf.vonmises&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_0.coupled.wing.def_mesh&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AS_point_1.coupled.wing.def_mesh&#39;</span><span class="p">,</span>
    <span class="p">]</span>

<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">recording_options</span><span class="p">[</span><span class="s1">&#39;record_objectives&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">recording_options</span><span class="p">[</span><span class="s1">&#39;record_constraints&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">recording_options</span><span class="p">[</span><span class="s1">&#39;record_desvars&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">recording_options</span><span class="p">[</span><span class="s1">&#39;record_inputs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>

<span class="c1">#docs checkpoint 27</span>

<span class="c1"># Set up the problem</span>
<span class="n">prob</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>

<span class="c1"># from openmdao.api import view_model</span>
<span class="c1"># view_model(prob)</span>

<span class="c1"># prob.check_partials(form=&#39;central&#39;, compact_print=True)</span>

<span class="n">prob</span><span class="o">.</span><span class="n">run_driver</span><span class="p">()</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 903186.853 1
NL: NLBGS 1 ; 975813.988 1.08041208
NL: NLBGS 2 ; 223223.177 0.247150605
NL: NLBGS 3 ; 82043.4593 0.0908377475
NL: NLBGS 4 ; 3175.71417 0.00351612089
NL: NLBGS 5 ; 1246.04787 0.0013796125
NL: NLBGS 6 ; 373.052902 0.000413040669
NL: NLBGS 7 ; 97.1527809 0.000107566646
NL: NLBGS 8 ; 30.8096983 3.41122085e-05
NL: NLBGS 9 ; 6.66101242 7.37501038e-06
NL: NLBGS 10 ; 2.1273057 2.35533289e-06
NL: NLBGS 11 ; 0.442153057 4.89547712e-07
NL: NLBGS 12 ; 0.142165279 1.57404061e-07
NL: NLBGS 13 ; 0.0286988845 3.17751354e-08
NL: NLBGS 14 ; 0.00927682168 1.02712098e-08
NL: NLBGS 15 ; 0.00183311486 2.02960756e-09
NL: NLBGS 16 ; 0.000594869674 6.58634115e-10
NL: NLBGS 17 ; 0.000115760331 1.28168751e-10
NL: NLBGS 18 ; 3.76699735e-05 4.17078408e-11
NL: NLBGS 19 ; 7.25249545e-06 8.02989484e-12
NL: NLBGS 20 ; 2.3647075e-06 2.61818193e-12
NL: NLBGS 21 ; 4.5135186e-07 4.99732539e-13
NL: NLBGS 22 ; 1.46549666e-07 1.62258414e-13
NL: NLBGS 23 ; 2.7620306e-08 3.05809434e-14
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 2460400.11 1
NL: NLBGS 1 ; 2980297.41 1.211306
NL: NLBGS 2 ; 2557340.55 1.03940027
NL: NLBGS 3 ; 1488766.49 0.605091215
NL: NLBGS 4 ; 890742.592 0.362031601
NL: NLBGS 5 ; 443653.134 0.180317474
NL: NLBGS 6 ; 411257.144 0.167150514
NL: NLBGS 7 ; 175877.313 0.0714832163
NL: NLBGS 8 ; 101157.749 0.0411143492
NL: NLBGS 9 ; 64992.2484 0.0264153168
NL: NLBGS 10 ; 37330.1497 0.0151723899
NL: NLBGS 11 ; 23951.6625 0.00973486481
NL: NLBGS 12 ; 13766.5624 0.00559525354
NL: NLBGS 13 ; 8824.15476 0.00358647145
NL: NLBGS 14 ; 5071.28709 0.00206116357
NL: NLBGS 15 ; 3249.78357 0.0013208354
NL: NLBGS 16 ; 1866.83775 0.000758753726
NL: NLBGS 17 ; 1196.36987 0.00048625013
NL: NLBGS 18 ; 687.027049 0.000279233872
NL: NLBGS 19 ; 440.310847 0.000178959042
NL: NLBGS 20 ; 252.807206 0.000102750445
NL: NLBGS 21 ; 162.026299 6.58536384e-05
NL: NLBGS 22 ; 93.0201625 3.7806925e-05
NL: NLBGS 23 ; 59.6176648 2.4230882e-05
NL: NLBGS 24 ; 34.2253801 1.39104936e-05
NL: NLBGS 25 ; 21.9353896 8.91537497e-06
NL: NLBGS 26 ; 12.5924478 5.11804879e-06
NL: NLBGS 27 ; 8.07060711 3.28020108e-06
NL: NLBGS 28 ; 4.63305139 1.88304795e-06
NL: NLBGS 29 ; 2.9693573 1.20685952e-06
NL: NLBGS 30 ; 1.70459663 6.92812775e-07
NL: NLBGS 31 ; 1.09248774 4.44028485e-07
NL: NLBGS 32 ; 0.627155117 2.54899646e-07
NL: NLBGS 33 ; 0.401947853 1.63366865e-07
NL: NLBGS 34 ; 0.230742602 9.37825522e-08
NL: NLBGS 35 ; 0.147884424 6.01058435e-08
NL: NLBGS 36 ; 0.084894659 3.45044119e-08
NL: NLBGS 37 ; 0.0544095293 2.2114098e-08
NL: NLBGS 38 ; 0.0312343762 1.26948361e-08
NL: NLBGS 39 ; 0.0200183105 8.13620127e-09
NL: NLBGS 40 ; 0.0114917287 4.67067477e-09
NL: NLBGS 41 ; 0.00736512248 2.99346535e-09
NL: NLBGS 42 ; 0.0042280273 1.71843079e-09
NL: NLBGS 43 ; 0.00270976958 1.10135322e-09
NL: NLBGS 44 ; 0.00155557279 6.32243829e-10
NL: NLBGS 45 ; 0.000996975626 4.05208739e-10
NL: NLBGS 46 ; 0.000572323629 2.32614048e-10
NL: NLBGS 47 ; 0.000366806341 1.49084021e-10
NL: NLBGS 48 ; 0.000210568031 8.5582841e-11
NL: NLBGS 49 ; 0.000134953693 5.48503035e-11
NL: NLBGS 50 ; 7.74721057e-05 3.14876045e-11
NL: NLBGS 51 ; 4.96532122e-05 2.01809502e-11
NL: NLBGS 52 ; 2.85039816e-05 1.15851001e-11
NL: NLBGS 53 ; 1.82672231e-05 7.42449288e-12
NL: NLBGS 54 ; 1.04871253e-05 4.2623658e-12
NL: NLBGS 55 ; 6.72213817e-06 2.73213212e-12
NL: NLBGS 56 ; 3.85969506e-06 1.56872658e-12
NL: NLBGS 57 ; 2.47438558e-06 1.00568423e-12
NL: NLBGS 58 ; 1.41964313e-06 5.76996857e-13
NL: NLBGS 59 ; 9.10080463e-07 3.69891246e-13
NL: NLBGS 60 ; 5.23036974e-07 2.1258208e-13
NL: NLBGS 61 ; 3.34959513e-07 1.36140261e-13
NL: NLBGS 62 ; 1.92383018e-07 7.81917612e-14
NL: NLBGS 63 ; 1.23041117e-07 5.00085805e-14
NL: NLBGS 64 ; 7.01913984e-08 2.85284487e-14
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 1.19162234e-08 1
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 7.03782144e-08 1
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 428649.971 1
NL: NLBGS 1 ; 196135.856 0.457566475
NL: NLBGS 2 ; 95416.8655 0.222598558
NL: NLBGS 3 ; 36735.9512 0.0857015134
NL: NLBGS 4 ; 550.35302 0.00128392175
NL: NLBGS 5 ; 375.41046 0.000875797237
NL: NLBGS 6 ; 78.113588 0.000182231642
NL: NLBGS 7 ; 29.5755108 6.89968804e-05
NL: NLBGS 8 ; 7.23358935 1.68752825e-05
NL: NLBGS 9 ; 1.98836617 4.63867096e-06
NL: NLBGS 10 ; 0.560715135 1.30809559e-06
NL: NLBGS 11 ; 0.150057739 3.50070569e-07
NL: NLBGS 12 ; 0.042777375 9.9795586e-08
NL: NLBGS 13 ; 0.0112516924 2.62491383e-08
NL: NLBGS 14 ; 0.0032356129 7.54838007e-09
NL: NLBGS 15 ; 0.000841439685 1.96299951e-09
NL: NLBGS 16 ; 0.000243417431 5.67869936e-10
NL: NLBGS 17 ; 6.28398526e-05 1.46599456e-10
NL: NLBGS 18 ; 1.82485846e-05 4.25722286e-11
NL: NLBGS 19 ; 4.68965678e-06 1.09405275e-11
NL: NLBGS 20 ; 1.36537812e-06 3.18529852e-12
NL: NLBGS 21 ; 3.49563539e-07 8.15498804e-13
NL: NLBGS 22 ; 1.02107949e-07 2.38208226e-13
NL: NLBGS 23 ; 2.65094067e-08 6.18439484e-14
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 1305082.81 1
NL: NLBGS 1 ; 947911.86 0.726323153
NL: NLBGS 2 ; 117645.966 0.0901444457
NL: NLBGS 3 ; 74465.6143 0.0570581528
NL: NLBGS 4 ; 10344.3604 0.00792620998
NL: NLBGS 5 ; 6249.94399 0.00478892523
NL: NLBGS 6 ; 2632.15669 0.00201685033
NL: NLBGS 7 ; 1180.26458 0.000904359919
NL: NLBGS 8 ; 677.726051 0.000519297356
NL: NLBGS 9 ; 443.579443 0.000339886052
NL: NLBGS 10 ; 255.740486 0.000195957287
NL: NLBGS 11 ; 168.270198 0.000128934499
NL: NLBGS 12 ; 97.1797889 7.44625462e-05
NL: NLBGS 13 ; 64.027001 4.9059723e-05
NL: NLBGS 14 ; 36.9988182 2.83497859e-05
NL: NLBGS 15 ; 24.3867046 1.86859442e-05
NL: NLBGS 16 ; 14.0947944 1.07999235e-05
NL: NLBGS 17 ; 9.29140926 7.11940208e-06
NL: NLBGS 18 ; 5.37045127 4.11502721e-06
NL: NLBGS 19 ; 3.54039847 2.71277688e-06
NL: NLBGS 20 ; 2.0463851 1.56801169e-06
NL: NLBGS 21 ; 1.34907 1.03370452e-06
NL: NLBGS 22 ; 0.779777752 5.97492931e-07
NL: NLBGS 23 ; 0.514066903 3.93896004e-07
NL: NLBGS 24 ; 0.297136481 2.27676343e-07
NL: NLBGS 25 ; 0.195886822 1.5009532e-07
NL: NLBGS 26 ; 0.113224749 8.67567547e-08
NL: NLBGS 27 ; 0.0746432772 5.71942844e-08
NL: NLBGS 28 ; 0.043144626 3.30589184e-08
NL: NLBGS 29 ; 0.0284430422 2.17940517e-08
NL: NLBGS 30 ; 0.0164403852 1.2597197e-08
NL: NLBGS 31 ; 0.0108383034 8.30468636e-09
NL: NLBGS 32 ; 0.00626465459 4.80019701e-09
NL: NLBGS 33 ; 0.00412996557 3.16452377e-09
NL: NLBGS 34 ; 0.00238716487 1.82912904e-09
NL: NLBGS 35 ; 0.00157373558 1.20585113e-09
NL: NLBGS 36 ; 0.000909635358 6.96994361e-10
NL: NLBGS 37 ; 0.000599675885 4.59492594e-10
NL: NLBGS 38 ; 0.000346619615 2.65592047e-10
NL: NLBGS 39 ; 0.000228508143 1.75090915e-10
NL: NLBGS 40 ; 0.000132079594 1.01203995e-10
NL: NLBGS 41 ; 8.70739403e-05 6.67190923e-11
NL: NLBGS 42 ; 5.03309867e-05 3.85653587e-11
NL: NLBGS 43 ; 3.31804279e-05 2.5424002e-11
NL: NLBGS 44 ; 1.91777885e-05 1.46946909e-11
NL: NLBGS 45 ; 1.26430745e-05 9.68756501e-12
NL: NLBGS 46 ; 7.30797205e-06 5.59962326e-12
NL: NLBGS 47 ; 4.81756838e-06 3.69138905e-12
NL: NLBGS 48 ; 2.78432212e-06 2.1334448e-12
NL: NLBGS 49 ; 1.83654402e-06 1.40722413e-12
NL: NLBGS 50 ; 1.06311773e-06 8.14597915e-13
NL: NLBGS 51 ; 7.00666402e-07 5.36875053e-13
NL: NLBGS 52 ; 4.04883981e-07 3.10236239e-13
NL: NLBGS 53 ; 2.67419416e-07 2.04906091e-13
NL: NLBGS 54 ; 1.54153471e-07 1.1811777e-13
NL: NLBGS 55 ; 1.01275501e-07 7.76008235e-14
NL: NLBGS 56 ; 5.87017843e-08 4.4979356e-14
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 73822.7296 1
NL: NLBGS 1 ; 41919.6913 0.567842607
NL: NLBGS 2 ; 18831.1318 0.255085823
NL: NLBGS 3 ; 7439.22166 0.100771425
NL: NLBGS 4 ; 174.356146 0.00236182199
NL: NLBGS 5 ; 72.9147656 0.000987700753
NL: NLBGS 6 ; 5.87523249 7.95856848e-05
NL: NLBGS 7 ; 0.837418795 1.13436444e-05
NL: NLBGS 8 ; 0.33403917 4.5248824e-06
NL: NLBGS 9 ; 0.0129751608 1.75761055e-07
NL: NLBGS 10 ; 0.00516149862 6.99174718e-08
NL: NLBGS 11 ; 0.000216793561 2.93667766e-09
NL: NLBGS 12 ; 8.66712741e-05 1.17404591e-09
NL: NLBGS 13 ; 3.41034492e-06 4.61964077e-11
NL: NLBGS 14 ; 1.35892799e-06 1.84079889e-11
NL: NLBGS 15 ; 5.48191307e-08 7.42577943e-13
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 289546.8 1
NL: NLBGS 1 ; 342880.916 1.1841986
NL: NLBGS 2 ; 466492.903 1.611114
NL: NLBGS 3 ; 297031.442 1.02584951
NL: NLBGS 4 ; 67190.6047 0.232054386
NL: NLBGS 5 ; 30821.0207 0.106445731
NL: NLBGS 6 ; 31317.1625 0.108159243
NL: NLBGS 7 ; 11779.7258 0.0406833225
NL: NLBGS 8 ; 7019.74742 0.024243913
NL: NLBGS 9 ; 4762.33458 0.016447547
NL: NLBGS 10 ; 2734.14173 0.00944283181
NL: NLBGS 11 ; 1919.67852 0.0066299421
NL: NLBGS 12 ; 1091.81112 0.00377075874
NL: NLBGS 13 ; 767.360519 0.0026502124
NL: NLBGS 14 ; 435.14895 0.00150286223
NL: NLBGS 15 ; 305.598061 0.00105543581
NL: NLBGS 16 ; 173.142709 0.000597978322
NL: NLBGS 17 ; 121.545925 0.000419779894
NL: NLBGS 18 ; 68.8487191 0.000237780971
NL: NLBGS 19 ; 48.3249676 0.000166898642
NL: NLBGS 20 ; 27.3723185 9.45350408e-05
NL: NLBGS 21 ; 19.2119321 6.63517337e-05
NL: NLBGS 22 ; 10.8821474 3.75833801e-05
NL: NLBGS 23 ; 7.63785248 2.63786458e-05
NL: NLBGS 24 ; 4.32633444 1.4941745e-05
NL: NLBGS 25 ; 3.03652707 1.04871719e-05
NL: NLBGS 26 ; 1.72000443 5.94033308e-06
NL: NLBGS 27 ; 1.20722272 4.16935266e-06
NL: NLBGS 28 ; 0.683820007 2.36169078e-06
NL: NLBGS 29 ; 0.479954618 1.65760637e-06
NL: NLBGS 30 ; 0.271866432 9.3893779e-07
NL: NLBGS 31 ; 0.190815769 6.59015293e-07
NL: NLBGS 32 ; 0.108086177 3.73294325e-07
NL: NLBGS 33 ; 0.075862821 2.62005386e-07
NL: NLBGS 34 ; 0.0429719535 1.48411081e-07
NL: NLBGS 35 ; 0.0301608796 1.04165819e-07
NL: NLBGS 36 ; 0.0170844207 5.90040046e-08
NL: NLBGS 37 ; 0.0119911045 4.14133553e-08
NL: NLBGS 38 ; 0.00679227866 2.34583103e-08
NL: NLBGS 39 ; 0.00476732184 1.64647713e-08
NL: NLBGS 40 ; 0.00270041541 9.32635214e-09
NL: NLBGS 41 ; 0.00189535042 6.54592082e-09
NL: NLBGS 42 ; 0.00107360716 3.70788819e-09
NL: NLBGS 43 ; 0.000753536167 2.60246761e-09
NL: NLBGS 44 ; 0.00042683607 1.47415226e-09
NL: NLBGS 45 ; 0.000299585068 1.0346689e-09
NL: NLBGS 46 ; 0.000169699296 5.86085899e-10
NL: NLBGS 47 ; 0.00011910796 4.11359959e-10
NL: NLBGS 48 ; 6.74670003e-05 2.33008966e-10
NL: NLBGS 49 ; 4.73537711e-05 1.63544447e-10
NL: NLBGS 50 ; 2.68234829e-05 9.26395421e-11
NL: NLBGS 51 ; 1.88260043e-05 6.50188652e-11
NL: NLBGS 52 ; 1.06635289e-05 3.6828343e-11
NL: NLBGS 53 ; 7.4850088e-06 2.58507737e-11
NL: NLBGS 54 ; 4.2388043e-06 1.46394445e-11
NL: NLBGS 55 ; 2.97427758e-06 1.02721825e-11
NL: NLBGS 56 ; 1.68504664e-06 5.81960029e-12
NL: NLBGS 57 ; 1.18257737e-06 4.08423568e-12
NL: NLBGS 58 ; 6.69086786e-07 2.31080705e-12
NL: NLBGS 59 ; 4.6909798e-07 1.62011109e-12
NL: NLBGS 60 ; 2.65583827e-07 9.17239725e-13
NL: NLBGS 61 ; 1.86273341e-07 6.43327233e-13
NL: NLBGS 62 ; 1.05995137e-07 3.66072556e-13
NL: NLBGS 63 ; 7.44694859e-08 2.57193262e-13
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 35099.7627 1
NL: NLBGS 1 ; 17196.5474 0.489933438
NL: NLBGS 2 ; 8626.59212 0.245773517
NL: NLBGS 3 ; 3415.87049 0.0973189055
NL: NLBGS 4 ; 8.406138 0.00023949273
NL: NLBGS 5 ; 3.52976409 0.000100563759
NL: NLBGS 6 ; 1.0745306 3.06136145e-05
NL: NLBGS 7 ; 0.150202127 4.27929182e-06
NL: NLBGS 8 ; 0.0578952075 1.64944726e-06
NL: NLBGS 9 ; 0.00489448101 1.39444846e-07
NL: NLBGS 10 ; 0.00187867719 5.35239287e-08
NL: NLBGS 11 ; 0.000155915108 4.44205591e-09
NL: NLBGS 12 ; 5.98575404e-05 1.70535456e-09
NL: NLBGS 13 ; 4.9017806e-06 1.39652813e-10
NL: NLBGS 14 ; 1.88194828e-06 5.36171228e-11
NL: NLBGS 15 ; 1.52393208e-07 4.34171618e-12
NL: NLBGS 16 ; 5.85714858e-08 1.66871458e-12
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 97208.0003 1
NL: NLBGS 1 ; 75119.1169 0.772766816
NL: NLBGS 2 ; 88929.7552 0.914839878
NL: NLBGS 3 ; 56713.5615 0.583424835
NL: NLBGS 4 ; 2461.79216 0.0253249954
NL: NLBGS 5 ; 1141.19973 0.0117397717
NL: NLBGS 6 ; 1036.29912 0.0106606361
NL: NLBGS 7 ; 460.267179 0.00473486933
NL: NLBGS 8 ; 248.676218 0.00255818675
NL: NLBGS 9 ; 170.079818 0.00174964835
NL: NLBGS 10 ; 91.8050922 0.0009444191
NL: NLBGS 11 ; 62.9975128 0.000648069218
NL: NLBGS 12 ; 34.1073639 0.000350869926
NL: NLBGS 13 ; 23.4405746 0.000241138327
NL: NLBGS 14 ; 12.7089107 0.000130739349
NL: NLBGS 15 ; 8.73963416 8.99065317e-05
NL: NLBGS 16 ; 4.74086355 4.87703021e-05
NL: NLBGS 17 ; 3.26090241 3.35456176e-05
NL: NLBGS 18 ; 1.76919859 1.82001335e-05
NL: NLBGS 19 ; 1.21699622 1.25195068e-05
NL: NLBGS 20 ; 0.660315654 6.79281182e-06
NL: NLBGS 21 ; 0.45422884 4.67275161e-06
NL: NLBGS 22 ; 0.246458738 2.53537504e-06
NL: NLBGS 23 ; 0.169539387 1.74408882e-06
NL: NLBGS 24 ; 0.0919903336 9.46324719e-07
NL: NLBGS 25 ; 0.0632804508 6.50979863e-07
NL: NLBGS 26 ; 0.0343353677 3.53215451e-07
NL: NLBGS 27 ; 0.0236194268 2.42978219e-07
NL: NLBGS 28 ; 0.01281568 1.31837709e-07
NL: NLBGS 29 ; 0.00881595564 9.06916675e-08
NL: NLBGS 30 ; 0.00478345394 4.92084388e-08
NL: NLBGS 31 ; 0.00329055628 3.38506735e-08
NL: NLBGS 32 ; 0.0017854252 1.83670603e-08
NL: NLBGS 33 ; 0.00122820079 1.26347707e-08
NL: NLBGS 34 ; 0.000666409482 6.85550037e-09
NL: NLBGS 35 ; 0.00045842607 4.71592944e-09
NL: NLBGS 36 ; 0.00024873825 2.55882488e-09
NL: NLBGS 37 ; 0.000171107441 1.76021974e-09
NL: NLBGS 38 ; 9.28417956e-05 9.55083895e-10
NL: NLBGS 39 ; 6.38656876e-05 6.57000323e-10
NL: NLBGS 40 ; 3.46530406e-05 3.56483422e-10
NL: NLBGS 41 ; 2.38385355e-05 2.45232239e-10
NL: NLBGS 42 ; 1.29340074e-05 1.33054968e-10
NL: NLBGS 43 ; 8.89750681e-06 9.15306022e-11
NL: NLBGS 44 ; 4.82724528e-06 4.965893e-11
NL: NLBGS 45 ; 3.32018723e-06 3.41554936e-11
NL: NLBGS 46 ; 1.80127054e-06 1.85300648e-11
NL: NLBGS 47 ; 1.23882743e-06 1.27440892e-11
NL: NLBGS 48 ; 6.72338479e-07 6.91649325e-12
NL: NLBGS 49 ; 4.62131178e-07 4.75404469e-12
NL: NLBGS 50 ; 2.49473562e-07 2.5663892e-12
NL: NLBGS 51 ; 1.72001355e-07 1.76941563e-12
NL: NLBGS 52 ; 9.32243618e-08 9.59019437e-13
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 194683.74 1
NL: NLBGS 1 ; 136957.456 0.703486874
NL: NLBGS 2 ; 56517.049 0.290301846
NL: NLBGS 3 ; 19576.2919 0.100554324
NL: NLBGS 4 ; 121.778017 0.000625517146
NL: NLBGS 5 ; 63.0334679 0.000323773665
NL: NLBGS 6 ; 13.564389 6.96739695e-05
NL: NLBGS 7 ; 7.01011246 3.60076937e-05
NL: NLBGS 8 ; 1.30135081 6.68443502e-06
NL: NLBGS 9 ; 0.551243109 2.83147996e-06
NL: NLBGS 10 ; 0.105182124 5.40271744e-07
NL: NLBGS 11 ; 0.0318902697 1.63805512e-07
NL: NLBGS 12 ; 0.00649823985 3.33784417e-08
NL: NLBGS 13 ; 0.00170709593 8.76855938e-09
NL: NLBGS 14 ; 0.000401518037 2.06241177e-09
NL: NLBGS 15 ; 0.000105536515 5.4209209e-10
NL: NLBGS 16 ; 2.24066088e-05 1.15092348e-10
NL: NLBGS 17 ; 6.03713784e-06 3.10099747e-11
NL: NLBGS 18 ; 1.20632713e-06 6.19634248e-12
NL: NLBGS 19 ; 3.30649219e-07 1.69839155e-12
NL: NLBGS 20 ; 6.31231703e-08 3.24234424e-13
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 550194.525 1
NL: NLBGS 1 ; 537334.5 0.976626402
NL: NLBGS 2 ; 560776.725 1.01923356
NL: NLBGS 3 ; 327107.77 0.594531125
NL: NLBGS 4 ; 44165.0294 0.0802716628
NL: NLBGS 5 ; 20953.636 0.0380840503
NL: NLBGS 6 ; 24126.091 0.0438501109
NL: NLBGS 7 ; 6976.40567 0.0126798893
NL: NLBGS 8 ; 3979.98565 0.00723377909
NL: NLBGS 9 ; 2111.00072 0.00383682612
NL: NLBGS 10 ; 1079.60323 0.00196222097
NL: NLBGS 11 ; 616.027413 0.00111965384
NL: NLBGS 12 ; 316.072473 0.000574474041
NL: NLBGS 13 ; 180.808847 0.000328627129
NL: NLBGS 14 ; 92.9238351 0.000168892693
NL: NLBGS 15 ; 53.1956776 9.66852179e-05
NL: NLBGS 16 ; 27.3546739 4.97181862e-05
NL: NLBGS 17 ; 15.663684 2.84693563e-05
NL: NLBGS 18 ; 8.05596954 1.46420387e-05
NL: NLBGS 19 ; 4.61340164 8.38503734e-06
NL: NLBGS 20 ; 2.37278584 4.31263076e-06
NL: NLBGS 21 ; 1.35886559 2.46979119e-06
NL: NLBGS 22 ; 0.698897275 1.27027305e-06
NL: NLBGS 23 ; 0.400254515 7.27478185e-07
NL: NLBGS 24 ; 0.205859384 3.74157456e-07
NL: NLBGS 25 ; 0.117894938 2.14278645e-07
NL: NLBGS 26 ; 0.060635613 1.10207591e-07
NL: NLBGS 27 ; 0.0347258385 6.31155654e-08
NL: NLBGS 28 ; 0.0178601161 3.24614572e-08
NL: NLBGS 29 ; 0.0102284391 1.85905869e-08
NL: NLBGS 30 ; 0.00526066337 9.56146077e-09
NL: NLBGS 31 ; 0.00301276802 5.47582334e-09
NL: NLBGS 32 ; 0.00154951768 2.81630878e-09
NL: NLBGS 33 ; 0.000887404798 1.61289282e-09
NL: NLBGS 34 ; 0.000456406126 8.29535927e-10
NL: NLBGS 35 ; 0.000261381923 4.75071836e-10
NL: NLBGS 36 ; 0.000134433796 2.44338666e-10
NL: NLBGS 37 ; 7.69900882e-05 1.39932487e-10
NL: NLBGS 38 ; 3.95963691e-05 7.19679445e-11
NL: NLBGS 39 ; 2.26755484e-05 4.12136932e-11
NL: NLBGS 40 ; 1.16620372e-05 2.11962073e-11
NL: NLBGS 41 ; 6.67843119e-06 1.21383091e-11
NL: NLBGS 42 ; 3.43446339e-06 6.24227111e-12
NL: NLBGS 43 ; 1.96731162e-06 3.57566557e-12
NL: NLBGS 44 ; 1.01151308e-06 1.83846445e-12
NL: NLBGS 45 ; 5.7871148e-07 1.05183068e-12
NL: NLBGS 46 ; 2.9766003e-07 5.41008708e-13
NL: NLBGS 47 ; 1.70188563e-07 3.09324349e-13
NL: NLBGS 48 ; 8.70919136e-08 1.58292948e-13
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 47830.835 1
NL: NLBGS 1 ; 20926.2567 0.43750557
NL: NLBGS 2 ; 6856.44364 0.143347772
NL: NLBGS 3 ; 2295.46796 0.0479913838
NL: NLBGS 4 ; 19.8201338 0.000414379841
NL: NLBGS 5 ; 7.10068416 0.000148454113
NL: NLBGS 6 ; 0.282582054 5.90794734e-06
NL: NLBGS 7 ; 0.0936814118 1.95859871e-06
NL: NLBGS 8 ; 0.0105909125 2.2142437e-07
NL: NLBGS 9 ; 0.0030271812 6.32893238e-08
NL: NLBGS 10 ; 0.000438568599 9.16916042e-09
NL: NLBGS 11 ; 0.000125628983 2.62652706e-09
NL: NLBGS 12 ; 1.90970807e-05 3.9926296e-10
NL: NLBGS 13 ; 5.44396639e-06 1.13817089e-10
NL: NLBGS 14 ; 8.46210214e-07 1.76917299e-11
NL: NLBGS 15 ; 2.40943265e-07 5.03740454e-12
NL: NLBGS 16 ; 3.87023775e-08 8.09151199e-13
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 138145.403 1
NL: NLBGS 1 ; 115968.245 0.839465103
NL: NLBGS 2 ; 129497.79 0.937402094
NL: NLBGS 3 ; 73696.1627 0.533468079
NL: NLBGS 4 ; 2772.41054 0.0200687861
NL: NLBGS 5 ; 1475.68894 0.010682143
NL: NLBGS 6 ; 1004.18378 0.00726903505
NL: NLBGS 7 ; 254.796779 0.00184441012
NL: NLBGS 8 ; 151.428297 0.00109615155
NL: NLBGS 9 ; 37.8299411 0.000273841476
NL: NLBGS 10 ; 22.1459678 0.000160309119
NL: NLBGS 11 ; 5.6527186 4.09186153e-05
NL: NLBGS 12 ; 3.31762024 2.40154227e-05
NL: NLBGS 13 ; 0.851728377 6.16544857e-06
NL: NLBGS 14 ; 0.500211414 3.62090525e-06
NL: NLBGS 15 ; 0.128646056 9.31236607e-07
NL: NLBGS 16 ; 0.0755682752 5.47019833e-07
NL: NLBGS 17 ; 0.0194445036 1.40753895e-07
NL: NLBGS 18 ; 0.0114226437 8.26856592e-08
NL: NLBGS 19 ; 0.00293950934 2.12783725e-08
NL: NLBGS 20 ; 0.00172683978 1.2500161e-08
NL: NLBGS 21 ; 0.000444395315 3.21686647e-09
NL: NLBGS 22 ; 0.000261064661 1.88978175e-09
NL: NLBGS 23 ; 6.71844527e-05 4.8633144e-10
NL: NLBGS 24 ; 3.94689023e-05 2.85705506e-10
NL: NLBGS 25 ; 1.01556402e-05 7.35141378e-11
NL: NLBGS 26 ; 5.96601646e-06 4.31865002e-11
NL: NLBGS 27 ; 1.53763167e-06 1.11305309e-11
NL: NLBGS 28 ; 9.03556592e-07 6.54062005e-12
NL: NLBGS 29 ; 2.32636069e-07 1.68399428e-12
NL: NLBGS 30 ; 1.36694688e-07 9.89498639e-13
NL: NLBGS 31 ; 3.46394527e-08 2.50746329e-13
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 25223.4031 1
NL: NLBGS 1 ; 3593.90435 0.142482929
NL: NLBGS 2 ; 1367.45363 0.054213685
NL: NLBGS 3 ; 445.972778 0.0176809123
NL: NLBGS 4 ; 8.56537209 0.000339580352
NL: NLBGS 5 ; 2.93820906 0.000116487417
NL: NLBGS 6 ; 0.187273345 7.4245868e-06
NL: NLBGS 7 ; 0.0654500851 2.59481581e-06
NL: NLBGS 8 ; 0.00688960229 2.7314325e-07
NL: NLBGS 9 ; 0.00244048689 9.67548623e-08
NL: NLBGS 10 ; 0.000355249951 1.40841404e-08
NL: NLBGS 11 ; 0.000126812333 5.02756638e-09
NL: NLBGS 12 ; 2.31107889e-05 9.16243889e-10
NL: NLBGS 13 ; 8.28736922e-06 3.28558728e-10
NL: NLBGS 14 ; 1.77970914e-06 7.05578521e-11
NL: NLBGS 15 ; 6.39691883e-07 2.53610459e-11
NL: NLBGS 16 ; 1.5605587e-07 6.18694749e-12
NL: NLBGS 17 ; 5.64141924e-08 2.23658133e-12
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 70557.8332 1
NL: NLBGS 1 ; 53462.6413 0.757713764
NL: NLBGS 2 ; 68290.8271 0.967870241
NL: NLBGS 3 ; 37643.2868 0.533509678
NL: NLBGS 4 ; 562.986433 0.00797907769
NL: NLBGS 5 ; 285.307545 0.00404359846
NL: NLBGS 6 ; 218.767341 0.00310053939
NL: NLBGS 7 ; 45.889693 0.000650384101
NL: NLBGS 8 ; 23.9270886 0.000339113144
NL: NLBGS 9 ; 8.66226899 0.000122768353
NL: NLBGS 10 ; 4.7549491 6.73908038e-05
NL: NLBGS 11 ; 1.6792641 2.37998253e-05
NL: NLBGS 12 ; 0.920979386 1.30528298e-05
NL: NLBGS 13 ; 0.321538278 4.55708833e-06
NL: NLBGS 14 ; 0.176124155 2.49616729e-06
NL: NLBGS 15 ; 0.0612163192 8.67604863e-07
NL: NLBGS 16 ; 0.03351098 4.7494344e-07
NL: NLBGS 17 ; 0.0116294993 1.64822228e-07
NL: NLBGS 18 ; 0.00636468492 9.02052207e-08
NL: NLBGS 19 ; 0.00220766829 3.12887768e-08
NL: NLBGS 20 ; 0.00120812985 1.71225475e-08
NL: NLBGS 21 ; 0.000418991363 5.93826857e-09
NL: NLBGS 22 ; 0.000229282466 3.24956785e-09
NL: NLBGS 23 ; 7.95165196e-05 1.12696941e-09
NL: NLBGS 24 ; 4.35130514e-05 6.16700505e-10
NL: NLBGS 25 ; 1.50887686e-05 2.1384966e-10
NL: NLBGS 26 ; 8.25584086e-06 1.1700814e-10
NL: NLBGS 27 ; 2.86450513e-06 4.05979747e-11
NL: NLBGS 28 ; 1.56821659e-06 2.22259744e-11
NL: NLBGS 29 ; 5.41049231e-07 7.66816675e-12
NL: NLBGS 30 ; 2.95707244e-07 4.190991e-12
NL: NLBGS 31 ; 1.02072181e-07 1.44664563e-12
NL: NLBGS 32 ; 5.52572788e-08 7.83148749e-13
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 12088.7307 1
NL: NLBGS 1 ; 1655.47088 0.136943317
NL: NLBGS 2 ; 626.307239 0.0518091811
NL: NLBGS 3 ; 210.903301 0.0174462734
NL: NLBGS 4 ; 4.27199241 0.000353386349
NL: NLBGS 5 ; 1.50664469 0.000124632165
NL: NLBGS 6 ; 0.0969965231 8.02371443e-06
NL: NLBGS 7 ; 0.0349837958 2.89391803e-06
NL: NLBGS 8 ; 0.00391988727 3.24259623e-07
NL: NLBGS 9 ; 0.00142697471 1.18041732e-07
NL: NLBGS 10 ; 0.000220882617 1.8271779e-08
NL: NLBGS 11 ; 8.08221959e-05 6.68574706e-09
NL: NLBGS 12 ; 1.55329812e-05 1.28491415e-09
NL: NLBGS 13 ; 5.69988723e-06 4.71504194e-10
NL: NLBGS 14 ; 1.27983475e-06 1.05870069e-10
NL: NLBGS 15 ; 4.70778137e-07 3.8943554e-11
NL: NLBGS 16 ; 1.19252973e-07 9.86480516e-12
NL: NLBGS 17 ; 4.41018188e-08 3.64817613e-12
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 33681.2917 1
NL: NLBGS 1 ; 25766.7572 0.765016895
NL: NLBGS 2 ; 34321.7745 1.01901598
NL: NLBGS 3 ; 19316.0503 0.573494939
NL: NLBGS 4 ; 192.306354 0.00570958964
NL: NLBGS 5 ; 102.913378 0.00305550567
NL: NLBGS 6 ; 65.3944749 0.00194156671
NL: NLBGS 7 ; 6.12829395 0.000181949493
NL: NLBGS 8 ; 3.32816358 9.88134187e-05
NL: NLBGS 9 ; 0.737125104 2.18852979e-05
NL: NLBGS 10 ; 0.40608226 1.20566118e-05
NL: NLBGS 11 ; 0.108737046 3.2284108e-06
NL: NLBGS 12 ; 0.0619591567 1.83957187e-06
NL: NLBGS 13 ; 0.0165590563 4.91639584e-07
NL: NLBGS 14 ; 0.00942818198 2.79923408e-07
NL: NLBGS 15 ; 0.00252368039 7.49282541e-08
NL: NLBGS 16 ; 0.00143724262 4.2671838e-08
NL: NLBGS 17 ; 0.000384812954 1.14251246e-08
NL: NLBGS 18 ; 0.000219164623 6.50701357e-09
NL: NLBGS 19 ; 5.867647e-05 1.74210866e-09
NL: NLBGS 20 ; 3.34181125e-05 9.9218619e-10
NL: NLBGS 21 ; 8.94648355e-06 2.65621747e-10
NL: NLBGS 22 ; 5.09524948e-06 1.51278327e-10
NL: NLBGS 23 ; 1.36539737e-06 4.05387471e-11
NL: NLBGS 24 ; 7.77700683e-07 2.30899898e-11
NL: NLBGS 25 ; 2.07177114e-07 6.15110357e-12
NL: NLBGS 26 ; 1.18439416e-07 3.51647487e-12
NL: NLBGS 27 ; 3.27602964e-08 9.72655582e-13
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 19893.6136 1
NL: NLBGS 1 ; 20991.4756 1.05518666
NL: NLBGS 2 ; 6639.189 0.333734692
NL: NLBGS 3 ; 1957.76022 0.0984114932
NL: NLBGS 4 ; 5.78554675 0.000290824326
NL: NLBGS 5 ; 1.81903376 9.14380765e-05
NL: NLBGS 6 ; 0.100938958 5.07393781e-06
NL: NLBGS 7 ; 0.0216924218 1.09042139e-06
NL: NLBGS 8 ; 0.00359255595 1.80588405e-07
NL: NLBGS 9 ; 0.000764329228 3.84208342e-08
NL: NLBGS 10 ; 0.000125297529 6.29837954e-09
NL: NLBGS 11 ; 2.69558537e-05 1.35500037e-09
NL: NLBGS 12 ; 4.31926905e-06 2.17118375e-10
NL: NLBGS 13 ; 9.39973941e-07 4.72500352e-11
NL: NLBGS 14 ; 1.47784419e-07 7.42873678e-12
NL: NLBGS 15 ; 3.31971965e-08 1.66873637e-12
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 78587.8344 1
NL: NLBGS 1 ; 112820.954 1.43560329
NL: NLBGS 2 ; 121413.307 1.54493768
NL: NLBGS 3 ; 63389.408 0.806605863
NL: NLBGS 4 ; 1000.97083 0.0127369693
NL: NLBGS 5 ; 491.844482 0.00625853206
NL: NLBGS 6 ; 614.649387 0.0078211773
NL: NLBGS 7 ; 138.725508 0.0017652288
NL: NLBGS 8 ; 103.945779 0.0013226701
NL: NLBGS 9 ; 23.563094 0.000299831319
NL: NLBGS 10 ; 16.8632868 0.000214578846
NL: NLBGS 11 ; 4.45556201 5.66953148e-05
NL: NLBGS 12 ; 2.05474156 2.61457969e-05
NL: NLBGS 13 ; 0.953521619 1.21331963e-05
NL: NLBGS 14 ; 0.348241809 4.43124322e-06
NL: NLBGS 15 ; 0.174739297 2.22349042e-06
NL: NLBGS 16 ; 0.0621100062 7.90325967e-07
NL: NLBGS 17 ; 0.0311033854 3.95778629e-07
NL: NLBGS 18 ; 0.0109375775 1.39176472e-07
NL: NLBGS 19 ; 0.00547250279 6.96354955e-08
NL: NLBGS 20 ; 0.00191650639 2.43868075e-08
NL: NLBGS 21 ; 0.000958550198 1.2197183e-08
NL: NLBGS 22 ; 0.000335176203 4.26498841e-09
NL: NLBGS 23 ; 0.000167615426 2.1328419e-09
NL: NLBGS 24 ; 5.857641e-05 7.45362313e-10
NL: NLBGS 25 ; 2.92905891e-05 3.72711493e-10
NL: NLBGS 26 ; 1.02320839e-05 1.30199337e-10
NL: NLBGS 27 ; 5.11669419e-06 6.51079678e-11
NL: NLBGS 28 ; 1.78859284e-06 2.27591567e-11
NL: NLBGS 29 ; 8.94751144e-07 1.13853645e-11
NL: NLBGS 30 ; 3.12272208e-07 3.97354388e-12
NL: NLBGS 31 ; 1.56092883e-07 1.98622197e-12
NL: NLBGS 32 ; 5.49955729e-08 6.99797536e-13
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 59896.9131 1
NL: NLBGS 1 ; 63309.1036 1.05696772
NL: NLBGS 2 ; 15630.871 0.260962881
NL: NLBGS 3 ; 3950.39356 0.065953208
NL: NLBGS 4 ; 8.59679948 0.000143526587
NL: NLBGS 5 ; 2.34083289 3.90810271e-05
NL: NLBGS 6 ; 0.123081976 2.05489681e-06
NL: NLBGS 7 ; 0.0113681276 1.89794883e-07
NL: NLBGS 8 ; 0.0026933766 4.49668682e-08
NL: NLBGS 9 ; 8.55275598e-05 1.42791265e-09
NL: NLBGS 10 ; 2.10567844e-05 3.51550411e-10
NL: NLBGS 11 ; 4.27111688e-07 7.13077964e-12
NL: NLBGS 12 ; 1.02021454e-07 1.703284e-12
NL: NLBGS 13 ; 2.76806397e-09 4.62138002e-14
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 185798.343 1
NL: NLBGS 1 ; 237830.83 1.28004818
NL: NLBGS 2 ; 196088.391 1.05538289
NL: NLBGS 3 ; 92038.6128 0.49536832
NL: NLBGS 4 ; 1385.09844 0.00745484819
NL: NLBGS 5 ; 701.284454 0.0037744387
NL: NLBGS 6 ; 758.02565 0.00407982999
NL: NLBGS 7 ; 171.710408 0.000924176208
NL: NLBGS 8 ; 128.843216 0.000693457296
NL: NLBGS 9 ; 29.7888058 0.000160328695
NL: NLBGS 10 ; 18.2052229 9.79837748e-05
NL: NLBGS 11 ; 4.49814708 2.42098343e-05
NL: NLBGS 12 ; 1.84661874 9.93883325e-06
NL: NLBGS 13 ; 0.701207619 3.77402516e-06
NL: NLBGS 14 ; 0.260545937 1.40230496e-06
NL: NLBGS 15 ; 0.0970476238 5.22327715e-07
NL: NLBGS 16 ; 0.0365464521 1.96699559e-07
NL: NLBGS 17 ; 0.0134171156 7.22133225e-08
NL: NLBGS 18 ; 0.00508257931 2.73553534e-08
NL: NLBGS 19 ; 0.00185437131 9.98055893e-09
NL: NLBGS 20 ; 0.000704252882 3.79041531e-09
NL: NLBGS 21 ; 0.000256278418 1.37933641e-09
NL: NLBGS 22 ; 9.74340889e-05 5.2440774e-10
NL: NLBGS 23 ; 3.54201489e-05 1.90637593e-10
NL: NLBGS 24 ; 1.34737628e-05 7.25182077e-11
NL: NLBGS 25 ; 4.89565471e-06 2.63492916e-11
NL: NLBGS 26 ; 1.86213634e-06 1.00223517e-11
NL: NLBGS 27 ; 6.75361133e-07 3.63491474e-12
NL: NLBGS 28 ; 2.56345574e-07 1.37969785e-12
NL: NLBGS 29 ; 9.2791694e-08 4.99421538e-13
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 45679.5413 1
NL: NLBGS 1 ; 48717.3862 1.0665034
NL: NLBGS 2 ; 14337.7926 0.313877772
NL: NLBGS 3 ; 4063.70125 0.0889610782
NL: NLBGS 4 ; 12.5385442 0.000274489275
NL: NLBGS 5 ; 3.27649412 7.17278245e-05
NL: NLBGS 6 ; 0.342367903 7.49499434e-06
NL: NLBGS 7 ; 0.0673777483 1.4750093e-06
NL: NLBGS 8 ; 0.0127646991 2.79440177e-07
NL: NLBGS 9 ; 0.00215925748 4.7269684e-08
NL: NLBGS 10 ; 0.000427493648 9.35853636e-09
NL: NLBGS 11 ; 6.84693873e-05 1.49890707e-09
NL: NLBGS 12 ; 1.39068717e-05 3.04444206e-10
NL: NLBGS 13 ; 2.14503886e-06 4.69584152e-11
NL: NLBGS 14 ; 4.4355403e-07 9.71012444e-12
NL: NLBGS 15 ; 6.68479465e-08 1.46341107e-12
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 146730.549 1
NL: NLBGS 1 ; 201882.443 1.37587192
NL: NLBGS 2 ; 198608.749 1.353561
NL: NLBGS 3 ; 101022.957 0.688493009
NL: NLBGS 4 ; 2244.72841 0.0152983031
NL: NLBGS 5 ; 1112.30543 0.00758059883
NL: NLBGS 6 ; 1386.49781 0.00944927839
NL: NLBGS 7 ; 312.143916 0.00212732739
NL: NLBGS 8 ; 234.802169 0.00160022688
NL: NLBGS 9 ; 52.7959975 0.000359815988
NL: NLBGS 10 ; 39.4463302 0.000268835157
NL: NLBGS 11 ; 8.86688158 6.04296899e-05
NL: NLBGS 12 ; 6.53659662 4.45483007e-05
NL: NLBGS 13 ; 1.47117026 1.00263392e-05
NL: NLBGS 14 ; 1.05227978 7.17151126e-06
NL: NLBGS 15 ; 0.258217862 1.75980983e-06
NL: NLBGS 16 ; 0.126069318 8.59189299e-07
NL: NLBGS 17 ; 0.0513381906 3.49880723e-07
NL: NLBGS 18 ; 0.0179849668 1.22571386e-07
NL: NLBGS 19 ; 0.00856084564 5.83439897e-08
NL: NLBGS 20 ; 0.00298764329 2.03614265e-08
NL: NLBGS 21 ; 0.00141518526 9.64478951e-09
NL: NLBGS 22 ; 0.000495568279 3.37740356e-09
NL: NLBGS 23 ; 0.000234513523 1.5982597e-09
NL: NLBGS 24 ; 8.23226703e-05 5.61046563e-10
NL: NLBGS 25 ; 3.89509693e-05 2.65459166e-10
NL: NLBGS 26 ; 1.36896949e-05 9.32981915e-11
NL: NLBGS 27 ; 6.47651606e-06 4.41388389e-11
NL: NLBGS 28 ; 2.27622524e-06 1.55129607e-11
NL: NLBGS 29 ; 1.07666426e-06 7.33769666e-12
NL: NLBGS 30 ; 3.78940727e-07 2.58256191e-12
NL: NLBGS 31 ; 1.78323212e-07 1.21531074e-12
NL: NLBGS 32 ; 6.21987773e-08 4.23897939e-13
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 59787.0817 1
NL: NLBGS 1 ; 62771.7762 1.04992206
NL: NLBGS 2 ; 15485.1163 0.259004384
NL: NLBGS 3 ; 3867.77071 0.0646924151
NL: NLBGS 4 ; 10.2444414 0.000171348744
NL: NLBGS 5 ; 2.78076828 4.65111894e-05
NL: NLBGS 6 ; 0.128222699 2.1446556e-06
NL: NLBGS 7 ; 0.00946295532 1.58277592e-07
NL: NLBGS 8 ; 0.00207230476 3.46614134e-08
NL: NLBGS 9 ; 0.000150281776 2.51361618e-09
NL: NLBGS 10 ; 3.10036176e-05 5.18567168e-10
NL: NLBGS 11 ; 2.68323763e-06 4.48798897e-11
NL: NLBGS 12 ; 5.4184772e-07 9.06295648e-12
NL: NLBGS 13 ; 5.10985278e-08 8.54675062e-13
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 181347.381 1
NL: NLBGS 1 ; 230234.964 1.26957976
NL: NLBGS 2 ; 187646.146 1.03473314
NL: NLBGS 3 ; 87194.9844 0.480817444
NL: NLBGS 4 ; 1225.69878 0.00675884467
NL: NLBGS 5 ; 622.715819 0.00343382857
NL: NLBGS 6 ; 641.295514 0.00353628218
NL: NLBGS 7 ; 145.720355 0.000803542645
NL: NLBGS 8 ; 108.367615 0.000597569231
NL: NLBGS 9 ; 25.1744284 0.000138818814
NL: NLBGS 10 ; 14.0982251 7.77415424e-05
NL: NLBGS 11 ; 3.66852577 2.02292735e-05
NL: NLBGS 12 ; 1.40675517 7.75724003e-06
NL: NLBGS 13 ; 0.533765186 2.94332999e-06
NL: NLBGS 14 ; 0.198332967 1.09366325e-06
NL: NLBGS 15 ; 0.0717718074 3.95769748e-07
NL: NLBGS 16 ; 0.0270210244 1.49001459e-07
NL: NLBGS 17 ; 0.00958809691 5.28714384e-08
NL: NLBGS 18 ; 0.00363316358 2.00342765e-08
NL: NLBGS 19 ; 0.00127810624 7.04783398e-09
NL: NLBGS 20 ; 0.000485696914 2.67826814e-09
NL: NLBGS 21 ; 0.000170229505 9.38692929e-10
NL: NLBGS 22 ; 6.47682101e-05 3.5714996e-10
NL: NLBGS 23 ; 2.26651285e-05 1.24981835e-10
NL: NLBGS 24 ; 8.62760577e-06 4.75750226e-11
NL: NLBGS 25 ; 3.01734462e-06 1.66384791e-11
NL: NLBGS 26 ; 1.14825133e-06 6.33177786e-12
NL: NLBGS 27 ; 4.01740248e-07 2.21530769e-12
NL: NLBGS 28 ; 1.53872444e-07 8.4849554e-13
NL: NLBGS 29 ; 5.40230119e-08 2.97897943e-13
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 54267.9663 1
NL: NLBGS 1 ; 57469.6921 1.05899845
NL: NLBGS 2 ; 16816.6373 0.309881472
NL: NLBGS 3 ; 4706.72364 0.0867311595
NL: NLBGS 4 ; 18.0907263 0.000333359209
NL: NLBGS 5 ; 4.74933706 8.75164002e-05
NL: NLBGS 6 ; 0.418182393 7.70587921e-06
NL: NLBGS 7 ; 0.0788047646 1.45214147e-06
NL: NLBGS 8 ; 0.0150296908 2.76953272e-07
NL: NLBGS 9 ; 0.00242155818 4.46222393e-08
NL: NLBGS 10 ; 0.000478984961 8.82629281e-09
NL: NLBGS 11 ; 7.34871803e-05 1.35415394e-09
NL: NLBGS 12 ; 1.48494964e-05 2.73632815e-10
NL: NLBGS 13 ; 2.20378425e-06 4.06093022e-11
NL: NLBGS 14 ; 4.51362508e-07 8.31729174e-12
NL: NLBGS 15 ; 6.55968711e-08 1.2087586e-12
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 170250.814 1
NL: NLBGS 1 ; 231769.467 1.36134131
NL: NLBGS 2 ; 224405.969 1.31809043
NL: NLBGS 3 ; 113023.613 0.663865328
NL: NLBGS 4 ; 2690.10773 0.0158008509
NL: NLBGS 5 ; 1336.80006 0.00785194515
NL: NLBGS 6 ; 1658.60671 0.0097421367
NL: NLBGS 7 ; 373.476325 0.00219368305
NL: NLBGS 8 ; 280.929084 0.00165008951
NL: NLBGS 9 ; 63.1767113 0.00037108023
NL: NLBGS 10 ; 47.2173772 0.000277340096
NL: NLBGS 11 ; 10.6211224 6.23851486e-05
NL: NLBGS 12 ; 7.80605818 4.58503427e-05
NL: NLBGS 13 ; 1.76164486 1.03473506e-05
NL: NLBGS 14 ; 1.23156838 7.23384722e-06
NL: NLBGS 15 ; 0.312855949 1.83761793e-06
NL: NLBGS 16 ; 0.138876321 8.15716047e-07
NL: NLBGS 17 ; 0.0600650746 3.5280345e-07
NL: NLBGS 18 ; 0.0204390522 1.20052596e-07
NL: NLBGS 19 ; 0.00969010288 5.69166316e-08
NL: NLBGS 20 ; 0.00321841735 1.89039762e-08
NL: NLBGS 21 ; 0.00152180799 8.93862387e-09
NL: NLBGS 22 ; 0.000501281776 2.94437226e-09
NL: NLBGS 23 ; 0.000236840001 1.39112404e-09
NL: NLBGS 24 ; 7.77934226e-05 4.56934217e-10
NL: NLBGS 25 ; 3.67453802e-05 2.15830863e-10
NL: NLBGS 26 ; 1.20574194e-05 7.08215081e-11
NL: NLBGS 27 ; 5.69421312e-06 3.34460257e-11
NL: NLBGS 28 ; 1.86825847e-06 1.09735655e-11
NL: NLBGS 29 ; 8.82702282e-07 5.18471694e-12
NL: NLBGS 30 ; 2.8981225e-07 1.70226645e-12
NL: NLBGS 31 ; 1.37137532e-07 8.05502943e-13
NL: NLBGS 32 ; 4.55896224e-08 2.67779174e-13
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 78417.3753 1
NL: NLBGS 1 ; 81933.6459 1.04484045
NL: NLBGS 2 ; 19781.8346 0.252263411
NL: NLBGS 3 ; 4804.81149 0.0612722815
NL: NLBGS 4 ; 14.2148567 0.000181271774
NL: NLBGS 5 ; 3.79401912 4.83823783e-05
NL: NLBGS 6 ; 0.171445463 2.18631983e-06
NL: NLBGS 7 ; 0.0112745421 1.43776071e-07
NL: NLBGS 8 ; 0.00242777383 3.09596415e-08
NL: NLBGS 9 ; 0.000161038382 2.05360587e-09
NL: NLBGS 10 ; 3.21802474e-05 4.1037139e-10
NL: NLBGS 11 ; 2.65400302e-06 3.38445785e-11
NL: NLBGS 12 ; 5.18743388e-07 6.61515877e-12
NL: NLBGS 13 ; 4.6432333e-08 5.92117917e-13
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 232528.311 1
NL: NLBGS 1 ; 290575.638 1.24963553
NL: NLBGS 2 ; 227708.222 0.979270961
NL: NLBGS 3 ; 103523.044 0.445206194
NL: NLBGS 4 ; 1652.4678 0.00710652305
NL: NLBGS 5 ; 851.153492 0.00366042952
NL: NLBGS 6 ; 765.90374 0.00329380856
NL: NLBGS 7 ; 174.268108 0.000749448991
NL: NLBGS 8 ; 120.018366 0.000516145174
NL: NLBGS 9 ; 28.061118 0.000120678286
NL: NLBGS 10 ; 11.709982 5.0359382e-05
NL: NLBGS 11 ; 3.88350818 1.67012274e-05
NL: NLBGS 12 ; 1.26886417 5.45681582e-06
NL: NLBGS 13 ; 0.475142536 2.043375e-06
NL: NLBGS 14 ; 0.158325353 6.80886351e-07
NL: NLBGS 15 ; 0.0583399761 2.50894078e-07
NL: NLBGS 16 ; 0.0196975549 8.47103512e-08
NL: NLBGS 17 ; 0.00720773979 3.09972569e-08
NL: NLBGS 18 ; 0.0024492454 1.05331063e-08
NL: NLBGS 19 ; 0.000893445483 3.84230841e-09
NL: NLBGS 20 ; 0.000304477426 1.30942088e-09
NL: NLBGS 21 ; 0.000110919169 4.7701361e-10
NL: NLBGS 22 ; 3.78468617e-05 1.62762382e-10
NL: NLBGS 23 ; 1.3779372e-05 5.92589004e-11
NL: NLBGS 24 ; 4.7037687e-06 2.02288e-11
NL: NLBGS 25 ; 1.71269738e-06 7.36554345e-12
NL: NLBGS 26 ; 5.84307096e-07 2.51284282e-12
NL: NLBGS 27 ; 2.11753315e-07 9.10656059e-13
NL: NLBGS 28 ; 7.26788656e-08 3.12559212e-13
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 71968.8408 1
NL: NLBGS 1 ; 75902.3385 1.05465557
NL: NLBGS 2 ; 22128.2506 0.307469877
NL: NLBGS 3 ; 6110.98457 0.0849115325
NL: NLBGS 4 ; 28.7849501 0.000399964065
NL: NLBGS 5 ; 7.41961112 0.00010309477
NL: NLBGS 6 ; 0.669657852 9.30483032e-06
NL: NLBGS 7 ; 0.125066511 1.73778694e-06
NL: NLBGS 8 ; 0.023101212 3.2098908e-07
NL: NLBGS 9 ; 0.00370580469 5.14917935e-08
NL: NLBGS 10 ; 0.000712544881 9.90074139e-09
NL: NLBGS 11 ; 0.000108649713 1.50967713e-09
NL: NLBGS 12 ; 2.1379079e-05 2.97060211e-10
NL: NLBGS 13 ; 3.15164918e-06 4.37918569e-11
NL: NLBGS 14 ; 6.30363631e-07 8.75884097e-12
NL: NLBGS 15 ; 9.13694184e-08 1.26956913e-12
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 221631.853 1
NL: NLBGS 1 ; 298728.182 1.34785762
NL: NLBGS 2 ; 283854.602 1.28074822
NL: NLBGS 3 ; 141469.886 0.638310261
NL: NLBGS 4 ; 4033.43092 0.0181987872
NL: NLBGS 5 ; 2010.91411 0.009073218
NL: NLBGS 6 ; 2471.99948 0.0111536291
NL: NLBGS 7 ; 556.778688 0.00251217811
NL: NLBGS 8 ; 418.666243 0.00188901657
NL: NLBGS 9 ; 94.1560665 0.000424830932
NL: NLBGS 10 ; 70.3883916 0.000317591496
NL: NLBGS 11 ; 15.8746309 7.16261257e-05
NL: NLBGS 12 ; 11.4571067 5.16943145e-05
NL: NLBGS 13 ; 2.63505986 1.18893554e-05
NL: NLBGS 14 ; 1.62065308 7.31236534e-06
NL: NLBGS 15 ; 0.487263169 2.198525e-06
NL: NLBGS 16 ; 0.18449865 8.3245548e-07
NL: NLBGS 17 ; 0.0846269092 3.818355e-07
NL: NLBGS 18 ; 0.0296125612 1.33611486e-07
NL: NLBGS 19 ; 0.0136720863 6.16882734e-08
NL: NLBGS 20 ; 0.00462681654 2.08761353e-08
NL: NLBGS 21 ; 0.00213927654 9.65238756e-09
NL: NLBGS 22 ; 0.000712137438 3.21315474e-09
NL: NLBGS 23 ; 0.000329326756 1.48591799e-09
NL: NLBGS 24 ; 0.000108809809 4.90948426e-10
NL: NLBGS 25 ; 5.03165095e-05 2.27027428e-10
NL: NLBGS 26 ; 1.65734872e-05 7.47793558e-11
NL: NLBGS 27 ; 7.66250444e-06 3.45731191e-11
NL: NLBGS 28 ; 2.51860365e-06 1.13639065e-11
NL: NLBGS 29 ; 1.16449083e-06 5.25416729e-12
NL: NLBGS 30 ; 3.82139941e-07 1.72421038e-12
NL: NLBGS 31 ; 1.75710695e-07 7.92804342e-13
NL: NLBGS 32 ; 6.01079574e-08 2.71206312e-13
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 78105.9791 1
NL: NLBGS 1 ; 81484.6449 1.04325745
NL: NLBGS 2 ; 19898.7106 0.254765523
NL: NLBGS 3 ; 4807.92507 0.0615564278
NL: NLBGS 4 ; 17.3248673 0.000221812305
NL: NLBGS 5 ; 4.62848702 5.92590615e-05
NL: NLBGS 6 ; 0.216188411 2.76788555e-06
NL: NLBGS 7 ; 0.0357866878 4.58181156e-07
NL: NLBGS 8 ; 0.00494445318 6.33044133e-08
NL: NLBGS 9 ; 0.000780660982 9.99489399e-09
NL: NLBGS 10 ; 0.000104912337 1.34320493e-09
NL: NLBGS 11 ; 1.69706438e-05 2.17277141e-10
NL: NLBGS 12 ; 2.1937051e-06 2.80862633e-11
NL: NLBGS 13 ; 3.63205724e-07 4.65016543e-12
NL: NLBGS 14 ; 4.50748943e-08 5.77099152e-13
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 230679.848 1
NL: NLBGS 1 ; 288780.104 1.25186533
NL: NLBGS 2 ; 227741.767 0.987263382
NL: NLBGS 3 ; 103019.831 0.446592247
NL: NLBGS 4 ; 1645.34592 0.00713259495
NL: NLBGS 5 ; 839.417313 0.00363888446
NL: NLBGS 6 ; 718.465162 0.00311455539
NL: NLBGS 7 ; 157.889182 0.000684451561
NL: NLBGS 8 ; 91.5520828 0.000396879414
NL: NLBGS 9 ; 22.5057178 9.75625658e-05
NL: NLBGS 10 ; 7.60767344 3.29793587e-05
NL: NLBGS 11 ; 3.04038485 1.3180106e-05
NL: NLBGS 12 ; 0.836876077 3.62786817e-06
NL: NLBGS 13 ; 0.341985061 1.48250948e-06
NL: NLBGS 14 ; 0.0905057912 3.92343727e-07
NL: NLBGS 15 ; 0.0369449706 1.60156906e-07
NL: NLBGS 16 ; 0.00962006088 4.17030832e-08
NL: NLBGS 17 ; 0.00392539601 1.70166404e-08
NL: NLBGS 18 ; 0.00101557307 4.40252184e-09
NL: NLBGS 19 ; 0.000414328231 1.79611802e-09
NL: NLBGS 20 ; 0.000106929077 4.63538875e-10
NL: NLBGS 21 ; 4.36207123e-05 1.89096329e-10
NL: NLBGS 22 ; 1.12489141e-05 4.87641823e-11
NL: NLBGS 23 ; 4.5891564e-06 1.98940499e-11
NL: NLBGS 24 ; 1.18014743e-06 5.11595372e-12
NL: NLBGS 25 ; 4.79577884e-07 2.07897607e-12
NL: NLBGS 26 ; 1.23466591e-07 5.35229204e-13
NL: NLBGS 27 ; 5.03681969e-08 2.18346758e-13
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 71633.4692 1
NL: NLBGS 1 ; 75383.0129 1.05234346
NL: NLBGS 2 ; 21904.966 0.305792338
NL: NLBGS 3 ; 5973.6367 0.0833916989
NL: NLBGS 4 ; 31.9105368 0.000445469655
NL: NLBGS 5 ; 8.31505699 0.000116077821
NL: NLBGS 6 ; 0.561399717 7.83711473e-06
NL: NLBGS 7 ; 0.0957139258 1.33616209e-06
NL: NLBGS 8 ; 0.0185665323 2.59187954e-07
NL: NLBGS 9 ; 0.00267079601 3.72841919e-08
NL: NLBGS 10 ; 0.000530707987 7.40865957e-09
NL: NLBGS 11 ; 7.33300812e-05 1.02368463e-09
NL: NLBGS 12 ; 1.47782131e-05 2.06303188e-10
NL: NLBGS 13 ; 1.989387e-06 2.77717528e-11
NL: NLBGS 14 ; 4.03796565e-07 5.63698184e-12
NL: NLBGS 15 ; 5.29267911e-08 7.38855617e-13
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 219477.943 1
NL: NLBGS 1 ; 294809.002 1.34322838
NL: NLBGS 2 ; 277614.144 1.26488403
NL: NLBGS 3 ; 137026.593 0.624329674
NL: NLBGS 4 ; 3638.48433 0.0165779043
NL: NLBGS 5 ; 1819.10967 0.00828834845
NL: NLBGS 6 ; 2207.96386 0.0100600718
NL: NLBGS 7 ; 498.474155 0.0022711811
NL: NLBGS 8 ; 373.535742 0.00170192839
NL: NLBGS 9 ; 84.220013 0.000383728824
NL: NLBGS 10 ; 61.7315153 0.000281265235
NL: NLBGS 11 ; 14.507608 6.61005282e-05
NL: NLBGS 12 ; 7.94748043 3.62108389e-05
NL: NLBGS 13 ; 2.57163896 1.17170725e-05
NL: NLBGS 14 ; 0.973112419 4.43375952e-06
NL: NLBGS 15 ; 0.416824269 1.89916245e-06
NL: NLBGS 16 ; 0.160334406 7.30526285e-07
NL: NLBGS 17 ; 0.067261662 3.06462057e-07
NL: NLBGS 18 ; 0.0262281593 1.19502484e-07
NL: NLBGS 19 ; 0.0109150467 4.97318616e-08
NL: NLBGS 20 ; 0.0042839572 1.95188507e-08
NL: NLBGS 21 ; 0.00177690059 8.09603262e-09
NL: NLBGS 22 ; 0.000699389064 3.18660296e-09
NL: NLBGS 23 ; 0.000289696375 1.31993389e-09
NL: NLBGS 24 ; 0.000114161774 5.20151467e-10
NL: NLBGS 25 ; 4.72604678e-05 2.15331286e-10
NL: NLBGS 26 ; 1.86341123e-05 8.49019815e-11
NL: NLBGS 27 ; 7.7131571e-06 3.51431993e-11
NL: NLBGS 28 ; 3.04063404e-06 1.3853939e-11
NL: NLBGS 29 ; 1.25724239e-06 5.72833138e-12
NL: NLBGS 30 ; 4.96947892e-07 2.26422703e-12
NL: NLBGS 31 ; 2.06595314e-07 9.4130331e-13
NL: NLBGS 32 ; 8.14434002e-08 3.71077836e-13
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 41133.9036 1
NL: NLBGS 1 ; 42421.8186 1.0313103
NL: NLBGS 2 ; 10701.8254 0.26017043
NL: NLBGS 3 ; 2646.24456 0.0643324443
NL: NLBGS 4 ; 13.9969181 0.000340276923
NL: NLBGS 5 ; 3.74224421 9.09771229e-05
NL: NLBGS 6 ; 0.159072362 3.86718371e-06
NL: NLBGS 7 ; 0.0400989933 9.74840454e-07
NL: NLBGS 8 ; 0.00074775922 1.81786593e-08
NL: NLBGS 9 ; 0.000178048841 4.32851797e-09
NL: NLBGS 10 ; 1.30826547e-05 3.18050406e-10
NL: NLBGS 11 ; 2.30382256e-06 5.60078756e-11
NL: NLBGS 12 ; 2.70660945e-07 6.57999658e-12
NL: NLBGS 13 ; 4.78844493e-08 1.16411148e-12
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 125563 1
NL: NLBGS 1 ; 160843.532 1.28097873
NL: NLBGS 2 ; 137030.859 1.09133151
NL: NLBGS 3 ; 63190.2239 0.503255128
NL: NLBGS 4 ; 803.991121 0.00640308943
NL: NLBGS 5 ; 391.213574 0.00311567558
NL: NLBGS 6 ; 271.790367 0.00216457369
NL: NLBGS 7 ; 44.2468888 0.000352387954
NL: NLBGS 8 ; 12.9231983 0.000102922025
NL: NLBGS 9 ; 5.19403109 4.13659364e-05
NL: NLBGS 10 ; 0.879268417 7.00260756e-06
NL: NLBGS 11 ; 0.377742943 3.00839373e-06
NL: NLBGS 12 ; 0.0763850769 6.08340646e-07
NL: NLBGS 13 ; 0.0327060468 2.60475193e-07
NL: NLBGS 14 ; 0.00708054813 5.63904024e-08
NL: NLBGS 15 ; 0.00304264793 2.42320422e-08
NL: NLBGS 16 ; 0.000672099868 5.35269041e-09
NL: NLBGS 17 ; 0.000289083392 2.30229758e-09
NL: NLBGS 18 ; 6.42910469e-05 5.12022225e-10
NL: NLBGS 19 ; 2.7662541e-05 2.2030806e-10
NL: NLBGS 20 ; 6.16658642e-06 4.9111493e-11
NL: NLBGS 21 ; 2.65390341e-06 2.11360305e-11
NL: NLBGS 22 ; 5.95195622e-07 4.74021503e-12
NL: NLBGS 23 ; 2.57419347e-07 2.05012102e-12
NL: NLBGS 24 ; 5.5584774e-08 4.4268434e-13
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 24841.8029 1
NL: NLBGS 1 ; 25526.1853 1.02754963
NL: NLBGS 2 ; 5926.0917 0.238553206
NL: NLBGS 3 ; 1365.11264 0.0549522372
NL: NLBGS 4 ; 8.17340478 0.000329018181
NL: NLBGS 5 ; 2.01645253 8.11717466e-05
NL: NLBGS 6 ; 0.068685675 2.76492312e-06
NL: NLBGS 7 ; 0.0171041335 6.88522232e-07
NL: NLBGS 8 ; 0.000765764054 3.08256232e-08
NL: NLBGS 9 ; 0.000198051273 7.9725e-09
NL: NLBGS 10 ; 1.3052955e-05 5.25443146e-10
NL: NLBGS 11 ; 3.48456481e-06 1.40270206e-10
NL: NLBGS 12 ; 3.19022091e-07 1.28421473e-11
NL: NLBGS 13 ; 8.79781516e-08 3.5415365e-12
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 82845.3263 1
NL: NLBGS 1 ; 104542.61 1.26190112
NL: NLBGS 2 ; 85561.1063 1.03278133
NL: NLBGS 3 ; 37313.4386 0.450398836
NL: NLBGS 4 ; 273.667768 0.00330335796
NL: NLBGS 5 ; 129.225905 0.00155984545
NL: NLBGS 6 ; 65.2675175 0.000787823772
NL: NLBGS 7 ; 9.31946297 0.00011249232
NL: NLBGS 8 ; 2.64081657 3.18764702e-05
NL: NLBGS 9 ; 1.09174212 1.31780774e-05
NL: NLBGS 10 ; 0.190987721 2.30535299e-06
NL: NLBGS 11 ; 0.079454229 9.59067126e-07
NL: NLBGS 12 ; 0.0129549451 1.56375087e-07
NL: NLBGS 13 ; 0.00537146115 6.4837226e-08
NL: NLBGS 14 ; 0.000847702456 1.0232351e-08
NL: NLBGS 15 ; 0.000350865196 4.23518395e-09
NL: NLBGS 16 ; 5.4679039e-05 6.60013562e-10
NL: NLBGS 17 ; 2.26149345e-05 2.72977795e-10
NL: NLBGS 18 ; 3.509044e-06 4.23565716e-11
NL: NLBGS 19 ; 1.45140789e-06 1.75194903e-11
NL: NLBGS 20 ; 2.24620978e-07 2.71132951e-12
NL: NLBGS 21 ; 9.31943283e-08 1.12491956e-12
NL: NLBGS Converged
Optimization terminated successfully.    (Exit mode 0)
            Current function value: 0.971339609672
            Iterations: 13
            Function evaluations: 19
            Gradient evaluations: 13
Optimization Complete
-----------------------------------</pre></div></div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s1">&#39;The fuel burn value is&#39;</span><span class="p">,</span> <span class="n">prob</span><span class="p">[</span><span class="s1">&#39;AS_point_0.fuelburn&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;[kg]&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>The fuel burn value is 97133.96096715276 [kg]</pre></div></div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s1">&#39;The wingbox mass (excluding the wing_weight_ratio) is&#39;</span><span class="p">,</span> <span class="n">prob</span><span class="p">[</span><span class="s1">&#39;wing.structural_mass&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">surf_dict</span><span class="p">[</span><span class="s1">&#39;wing_weight_ratio&#39;</span><span class="p">],</span> <span class="s1">&#39;[kg]&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>The wingbox mass (excluding the wing_weight_ratio) is 23723.255009158416 [kg]</pre></div></div><p>The following are the visualization results (keep in mind that this is with a very large optimization tolerance) for this problem using the <cite>plot_wingbox.py</cite> visualization script (located in the <cite>utils</cite> directory).
This visualization script requires the <cite>.db</cite> file as an argument.
For example, to use it for this example problem, from the example script’s (wingbox_mpt_opt_example.py) location in the OpenAeroStruct <cite>docs</cite> directory, we would use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">../</span><span class="n">utils</span><span class="o">/</span><span class="n">plot_wingbox</span><span class="o">.</span><span class="n">py</span> <span class="n">aerostruct</span><span class="o">.</span><span class="n">db</span>
</pre></div>
</div>
<img alt="_images/wingbox_opt.png" src="_images/wingbox_opt.png" />
<p>This plotting script currently only works for two-flight-point problems like the one described in this walkthrough.</p>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="more_examples.html" title="More Examples"
             >next</a> |</li>
        <li class="right" >
          <a href="aerostructural_walkthrough.html" title="Aerostructural Walkthrough"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">OpenAeroStruct 2.1.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, John Jasa, Dr. John Hwang, Justin S. Gray.
      Last updated on Apr 01, 2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>